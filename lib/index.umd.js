!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("axios")):"function"==typeof define&&define.amd?define(["exports","rxjs","axios"],e):e(t.taurus={},t.rxjs,t.axios)}(this,function(t,e,r){"use strict";var n;r=r&&r.hasOwnProperty("default")?r.default:r,(n=t.FieldType||(t.FieldType={}))[n.ID=0]="ID",n[n.COMPOSITE=1]="COMPOSITE",n[n.TO_ONE=2]="TO_ONE",n[n.TO_MANY=3]="TO_MANY",n[n.SCALAR=4]="SCALAR";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function o(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function s(t,e,r,n){return new(r||(r=Promise))(function(i,o){function s(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(s,a)}u((n=n.apply(t,e||[])).next())})}function a(t){return"function"==typeof t}var u=!1,c={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;u=t},get useDeprecatedSynchronousErrorHandling(){return u}};function h(t){setTimeout(function(){throw t},0)}var l={closed:!0,next:function(t){},error:function(t){if(c.useDeprecatedSynchronousErrorHandling)throw t;h(t)},complete:function(){}},f=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function d(t){return null!==t&&"object"==typeof t}var p=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),y=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var r=this._parentOrParents,n=this._unsubscribe,i=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof t)r.remove(this);else if(null!==r)for(var o=0;o<r.length;++o){r[o].remove(this)}if(a(n))try{n.call(this)}catch(t){e=t instanceof p?b(t.errors):[t]}if(f(i)){o=-1;for(var s=i.length;++o<s;){var u=i[o];if(d(u))try{u.unsubscribe()}catch(t){e=e||[],t instanceof p?e=e.concat(b(t.errors)):e.push(t)}}}if(e)throw new p(e)}},t.prototype.add=function(e){var r=e;if(!e)return t.EMPTY;switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof t)){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=r._parentOrParents;if(null===i)r._parentOrParents=this;else if(i instanceof t){if(i===this)return r;r._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return r;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[r]:o.push(r),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.EMPTY=((e=new t).closed=!0,e),t}();function b(t){return t.reduce(function(t,e){return t.concat(e instanceof p?e.errors:e)},[])}var v=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),m=function(t){function e(r,n,i){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=l;break;case 1:if(!r){o.destination=l;break}if("object"==typeof r){r instanceof e?(o.syncErrorThrowable=r.syncErrorThrowable,o.destination=r,r.add(o)):(o.syncErrorThrowable=!0,o.destination=new g(o,r));break}default:o.syncErrorThrowable=!0,o.destination=new g(o,r,n,i)}return o}return o(e,t),e.prototype[v]=function(){return this},e.create=function(t,r,n){var i=new e(t,r,n);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(y),g=function(t){function e(e,r,n,i){var o,s=t.call(this)||this;s._parentSubscriber=e;var u=s;return a(r)?o=r:r&&(o=r.next,n=r.error,i=r.complete,r!==l&&(a((u=Object.create(r)).unsubscribe)&&s.add(u.unsubscribe.bind(u)),u.unsubscribe=s.unsubscribe.bind(s))),s._context=u,s._next=o,s._error=n,s._complete=i,s}return o(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;c.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=c.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):h(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;h(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};c.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),c.useDeprecatedSynchronousErrorHandling)throw t;h(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!c.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return c.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(h(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(m),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(m),w=function(t){function e(e,r,n){var i=t.call(this)||this;return i.parent=e,i.outerValue=r,i.outerIndex=n,i.index=0,i}return o(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(m),S=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.complete()}};var E=function(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}(),O=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}(),x=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function I(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var j=function(t){if(t&&"function"==typeof t[O])return n=t,function(t){var e=n[O]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(x(t))return S(t);if(I(t))return r=t,function(t){return r.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,h),t};if(t&&"function"==typeof t[E])return e=t,function(t){for(var r=e[E]();;){var n=r.next();if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return"function"==typeof r.return&&t.add(function(){r.return&&r.return()}),t};var e,r,n,i=d(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function k(){}var A=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,i=function(t,e,r){if(t){if(t instanceof m)return t;if(t[v])return t[v]()}return t||e||r?new m(t,e,r):new m(l)}(t,e,r);if(n?i.add(n.call(i,this.source)):i.add(this.source||c.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),c.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){c.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,n=e.destination,i=e.isStopped;if(r||i)return!1;t=n&&n instanceof m?n:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=$(e))(function(e,n){var i;i=r.subscribe(function(e){try{t(e)}catch(t){n(t),i&&i.unsubscribe()}},n,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[O]=function(){return this},t.prototype.pipe=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 0===e.length?this:((t=e)?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:k)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=$(t))(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(e){return new t(e)},t}();function $(t){if(t||(t=c.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function T(t,e,r,n,i){if(void 0===i&&(i=new w(t,r,n)),!i.closed)return e instanceof A?e.subscribe(i):j(e)(i)}var N=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new R(t,this.durationSelector))},t}(),R=function(t){function e(e,r){var n=t.call(this,e)||this;return n.durationSelector=r,n.hasValue=!1,n}return o(e,t),e.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=void 0;try{e=(0,this.durationSelector)(t)}catch(t){return this.destination.error(t)}var r=T(this,e);!r||r.closed?this.clearThrottle():this.add(this.throttled=r)}},e.prototype.clearThrottle=function(){var t=this.value,e=this.hasValue,r=this.throttled;r&&(this.remove(r),this.throttled=null,r.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))},e.prototype.notifyNext=function(t,e,r,n){this.clearThrottle()},e.prototype.notifyComplete=function(){this.clearThrottle()},e}(_),P=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n.pending=!1,n}return o(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},e.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),setInterval(t.flush.bind(t,this),r)},e.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var r=!1,n=void 0;try{this.work(t)}catch(t){r=!0,n=!!t&&t||new Error(t)}if(r)return this.unsubscribe(),n},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,r=e.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,r){return t.call(this)||this}return o(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(y)),C=function(){function t(e,r){void 0===r&&(r=t.now),this.SchedulerAction=e,this.now=r}return t.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(r,e)},t.now=function(){return Date.now()},t}(),D=function(t){function e(r,n){void 0===n&&(n=C.now);var i=t.call(this,r,function(){return e.delegate&&e.delegate!==i?e.delegate.now():n()})||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return o(e,t),e.prototype.schedule=function(r,n,i){return void 0===n&&(n=0),e.delegate&&e.delegate!==this?e.delegate.schedule(r,n,i):t.prototype.schedule.call(this,r,n,i)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var r;this.active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},e}(C),F=new D(P);function L(t){return!f(t)&&t-parseFloat(t)+1>=0}function B(t){return t&&"function"==typeof t.schedule}function z(t){var e=t.index,r=t.period,n=t.subscriber;if(n.next(e),!n.closed){if(-1===r)return n.complete();t.index=e+1,this.schedule(t,r)}}function M(t,e){return void 0===e&&(e=F),r=function(){return function(t,e,r){void 0===t&&(t=0);var n=-1;return L(e)?n=Number(e)<1?1:Number(e):B(e)&&(r=e),B(r)||(r=F),new A(function(e){var i=L(t)?t:+t-r.now();return r.schedule(z,i,{index:0,period:n,subscriber:e})})}(t,e)},function(t){return t.lift(new N(r))};var r}function U(t,e){return new A(function(r){var n=new y,i=0;return n.add(e.schedule(function(){i!==t.length?(r.next(t[i++]),r.closed||n.add(this.schedule())):r.complete()})),n})}function V(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[O]}(t))return function(t,e){return new A(function(r){var n=new y;return n.add(e.schedule(function(){var i=t[O]();n.add(i.subscribe({next:function(t){n.add(e.schedule(function(){return r.next(t)}))},error:function(t){n.add(e.schedule(function(){return r.error(t)}))},complete:function(){n.add(e.schedule(function(){return r.complete()}))}}))})),n})}(t,e);if(I(t))return function(t,e){return new A(function(r){var n=new y;return n.add(e.schedule(function(){return t.then(function(t){n.add(e.schedule(function(){r.next(t),n.add(e.schedule(function(){return r.complete()}))}))},function(t){n.add(e.schedule(function(){return r.error(t)}))})})),n})}(t,e);if(x(t))return U(t,e);if(function(t){return t&&"function"==typeof t[E]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new A(function(r){var n,i=new y;return i.add(function(){n&&"function"==typeof n.return&&n.return()}),i.add(e.schedule(function(){n=t[E](),i.add(e.schedule(function(){if(!r.closed){var t,e;try{var i=n.next();t=i.value,e=i.done}catch(t){return void r.error(t)}e?r.complete():(r.next(t),this.schedule())}}))})),i})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}var H=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new q(t,this.project,this.thisArg))},t}(),q=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.project=r,i.count=0,i.thisArg=n||i,i}return o(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(m);function Q(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof e?function(n){return n.pipe(Q(function(r,n){return(i=t(r,n),o?V(i,o):i instanceof A?i:new A(j(i))).pipe(function(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new H(t,e))}}(function(t,i){return e(r,t,n,i)}));var i,o},r))}:("number"==typeof e&&(r=e),function(e){return e.lift(new Y(t,r))})}var Y=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new W(t,this.project,this.concurrent))},t}(),W=function(t){function e(e,r,n){void 0===n&&(n=Number.POSITIVE_INFINITY);var i=t.call(this,e)||this;return i.project=r,i.concurrent=n,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return o(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,r)},e.prototype._innerSub=function(t,e,r){var n=new w(this,void 0,void 0);this.destination.add(n),T(this,t,e,r,n)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(_);function J(t){return t}var G,K=new A(function(t){return t.complete()});function X(t){return t?function(t){return new A(function(e){return t.schedule(function(){return e.complete()})})}(t):K}G||(G={});var Z=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}();var tt=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new et(t,this.predicate,this.thisArg))},t}(),et=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.predicate=r,i.thisArg=n,i.count=0,i}return o(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(m);var rt=function(){function t(t){if(this.total=t,this.total<0)throw new Z}return t.prototype.call=function(t,e){return e.subscribe(new nt(t,this.total))},t}(),nt=function(t){function e(e,r){var n=t.call(this,e)||this;return n.total=r,n.count=0,n}return o(e,t),e.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},e}(m),it=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),ot=function(t){function e(e,r){var n=t.call(this)||this;return n.subject=e,n.subscriber=r,n.closed=!1,n}return o(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(y),st=function(t){function e(e){var r=t.call(this,e)||this;return r.destination=e,r}return o(e,t),e}(m),at=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return o(e,t),e.prototype[v]=function(){return new st(this)},e.prototype.lift=function(t){var e=new ut(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new it;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new it;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new it;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new it;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new it;return this.hasError?(t.error(this.thrownError),y.EMPTY):this.isStopped?(t.complete(),y.EMPTY):(this.observers.push(t),new ot(this,t))},e.prototype.asObservable=function(){var t=new A;return t.source=this,t},e.create=function(t,e){return new ut(t,e)},e}(A),ut=function(t){function e(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return o(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):y.EMPTY},e}(at);function ct(){return function(t){return t.lift(new ht(t))}}var ht=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var r=this.connectable;r._refCount++;var n=new lt(t,r),i=e.subscribe(n);return n.closed||(n.connection=r.connect()),i},t}(),lt=function(t){function e(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return o(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var r=this.connection,n=t._connection;this.connection=null,!n||r&&n!==r||n.unsubscribe()}}else this.connection=null},e}(m),ft=function(t){function e(e,r){var n=t.call(this)||this;return n.source=e,n.subjectFactory=r,n._refCount=0,n._isComplete=!1,n}return o(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new y).add(this.source.subscribe(new pt(this.getSubject(),this))),t.closed&&(this._connection=null,t=y.EMPTY)),t},e.prototype.refCount=function(){return ct()(this)},e}(A),dt=function(){var t=ft.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}}(),pt=function(t){function e(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return o(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(st);var yt=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var r=this.selector,n=this.subjectFactory(),i=r(n).subscribe(t);return i.add(e.subscribe(n)),i},t}();function bt(){return new at}function vt(){return function(t){return ct()((e=bt,function(t){var n;if(n="function"==typeof e?e:function(){return e},"function"==typeof r)return t.lift(new yt(n,r));var i=Object.create(t,dt);return i.source=t,i.subjectFactory=n,i})(t));var e,r}}class mt extends e.ReplaySubject{complete(){}error(t){this.error=t,this.observers.forEach(e=>{e.error(t),e.closed=!1})}}const gt=(t,e)=>{if(-1===e.indexOf("#")&&-1===e.indexOf("*"))return t===e;const r=(t=>`^${t.split(".").reduce((t,e,r,n)=>{let i="";return n[r-1]&&(i="#"!==n[r-1]?"\\.\\b":"\\b"),t+(i+="#"===e?"[\\s\\S]*":"*"===e?"[^.]+":e)},"")}`)(e);return new RegExp(r).test(t)},_t=(t,e)=>{const r=t.filter(t=>t.name===e);if(r&&!(r.length<1))return r[0]};class wt{constructor(){if(this.subjects=[],this.messageBus=new mt,this.messageStream=this.messageBus.pipe(vt()),wt._instance)throw new Error("Error: Instantiation failed: Use EntityMessageBroker.getInstance() instead of new.");wt._instance=this}static getInstance(){return wt._instance}emit(t,e={}){const r=this.subject(t);return r.next(e),r}subject(t){let r=_t(this.subjects,t);return r||((r=new e.Subject).name=t,this.subjects.push(r),this.messageBus.next(r)),r}on(t){return-1===t.indexOf("#")&&-1===t.indexOf("*")?this.subject(t):this.messageStream.pipe((r=(e=>gt(e.name,t)),function(t){return t.lift(new tt(r,n))}),(void 0===e&&(e=Number.POSITIVE_INFINITY),Q(J,e)));var e,r,n}}wt._instance=new wt;class St{constructor(t){this.obj=t}have(t){const e=t.split(".");let r=this.obj;for(const t of e)if(r=r[t],!1===this.check(r))return r;return r}check(t){return void 0!==t}}function Et(t){return new St(t)}class Ot{constructor(t){this.reference={},this.reference=t}get aBoolean(){return this.a(Boolean)}get aDate(){return this.a(Date)}get aFunction(){return this.a(Function)}get anArray(){return this.a(Array)}get anError(){return this.a(Error)}get anObject(){return this.a(Object)}get aNonEmptyArray(){return this.anArray&&!!this.reference.length}get aNonEmptyString(){return this.aString&&!!this.reference.trim()}get aNumber(){return this.a(Number)}get aRegExp(){return this.a(RegExp)}get aString(){return this.a(String)}get defined(){return!this.undefined&&!this.null&&!this.nan}get nan(){return this.a(NaN)}get null(){return this.a(null)}get undefined(){return this.a(void 0)}a(t){let e=!1;const r=this.reference.constructor.name;switch(t){case void 0:e="Undefined"===r;break;case null:e="Null"===r;break;case Array:e="Array"===r;break;case Boolean:e="Boolean"===r;break;case Date:e="Date"===r;break;case Error:e="Error"===r;break;case Function:e="Function"===r;break;case Number:e="Number"===r&&!isNaN(this.reference);break;case RegExp:e="RegExp"===r;break;case String:e="String"===r;break;case Object:e="Object"===r||"Arguments"===r;break;default:e="Number"===t.constructor.name&&isNaN(t)?"Number"===r&&isNaN(this.reference):this.reference instanceof t}return e}aTypeOf(t){let e=!1;if("function"==typeof t&&!(e=t===this.reference)&&!(e=t.isPrototypeOf(this.reference))){let r=this.reference;for(;"function"==typeof r&&!(e=r===t)&&r!==Object;)r="object"==typeof r.prototype&&Object.getPrototypeOf(r).constructor===Function?(Object.getPrototypeOf(r.prototype)||{}).constructor:Object.getPrototypeOf(r)}return e}}function xt(t){return new Ot(t)}class It{constructor(){this.dataStore={}}setItem(t,e){this.dataStore[t]=e||""}getItem(t){return this.dataStore[t]}removeItem(t){delete this.dataStore[t]}clear(){this.dataStore={}}get length(){return Object.keys(this.dataStore).length}key(t){return Object.keys(this.dataStore)[t]||null}}class jt{constructor(){this.storageSize=5242880;const t=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,e="undefined"!=typeof InstallTrigger,r=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString();var n=!!document.documentMode,i=!n&&!!window.StyleMedia,o=!(!window.chrome||!window.chrome.webstore&&!window.chrome.runtime);(o||t)&&window.CSS;t?this.name="opera":r?this.name="safari":n?this.name="IE":i?this.name="edge":o?this.name="chrome":e&&(this.name="firefox"),(o||e)&&(this.storageSize=10485760)}getStorageSize(){return this.storageSize}}var kt="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function At(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function $t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Tt(t,e){return t(e={exports:{}},e.exports),e.exports}var Nt=Tt(function(t,e){t.exports=function t(e,r,n){function i(s,a){if(!r[s]){if(!e[s]){var u=At;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var h=r[s]={exports:{}};e[s][0].call(h.exports,function(t){var r=e[s][1][t];return i(r||t)},h,h.exports,t,e,r,n)}return r[s].exports}for(var o=At,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){(function(t){var r,n,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var o=0,s=new i(h),a=t.document.createTextNode("");s.observe(a,{characterData:!0}),r=function(){a.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){h(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(h,0)};else{var u=new t.MessageChannel;u.port1.onmessage=h,r=function(){u.port2.postMessage(0)}}var c=[];function h(){var t,e;n=!0;for(var r=c.length;r;){for(e=c,c=[],t=-1;++t<r;)e[t]();r=c.length}n=!1}e.exports=function(t){1!==c.push(t)||n||r()}}).call(this,void 0!==kt?kt:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,r){var n=t(1);function i(){}var o={},s=["REJECTED"],a=["FULFILLED"],u=["PENDING"];function c(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,t!==i&&d(this,t)}function h(t,e,r){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function l(t,e,r){n(function(){var n;try{n=e(r)}catch(e){return o.reject(t,e)}n===t?o.reject(t,new TypeError("Cannot resolve promise with itself")):o.resolve(t,n)})}function f(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function d(t,e){var r=!1;function n(e){r||(r=!0,o.reject(t,e))}function i(e){r||(r=!0,o.resolve(t,e))}var s=p(function(){e(i,n)});"error"===s.status&&n(s.value)}function p(t,e){var r={};try{r.value=t(e),r.status="success"}catch(t){r.status="error",r.value=t}return r}e.exports=c,c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===s)return this;var r=new this.constructor(i);if(this.state!==u){var n=this.state===a?t:e;l(r,n,this.outcome)}else this.queue.push(new h(r,t,e));return r},h.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},h.prototype.otherCallFulfilled=function(t){l(this.promise,this.onFulfilled,t)},h.prototype.callRejected=function(t){o.reject(this.promise,t)},h.prototype.otherCallRejected=function(t){l(this.promise,this.onRejected,t)},o.resolve=function(t,e){var r=p(f,e);if("error"===r.status)return o.reject(t,r.value);var n=r.value;if(n)d(t,n);else{t.state=a,t.outcome=e;for(var i=-1,s=t.queue.length;++i<s;)t.queue[i].callFulfilled(e)}return t},o.reject=function(t,e){t.state=s,t.outcome=e;for(var r=-1,n=t.queue.length;++r<n;)t.queue[r].callRejected(e);return t},c.resolve=function(t){return t instanceof this?t:o.resolve(new this(i),t)},c.reject=function(t){var e=new this(i);return o.reject(e,t)},c.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,n=!1;if(!r)return this.resolve([]);for(var s=new Array(r),a=0,u=-1,c=new this(i);++u<r;)h(t[u],u);return c;function h(t,i){e.resolve(t).then(function(t){s[i]=t,++a!==r||n||(n=!0,o.resolve(c,s))},function(t){n||(n=!0,o.reject(c,t))})}},c.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,n=!1;if(!r)return this.resolve([]);for(var s,a=-1,u=new this(i);++a<r;)s=t[a],e.resolve(s).then(function(t){n||(n=!0,o.resolve(u,t))},function(t){n||(n=!0,o.reject(u,t))});return u}},{1:1}],3:[function(t,e,r){(function(e){"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==kt?kt:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();function o(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(o){if("TypeError"!==o.name)throw o;for(var r="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,n=new r,i=0;i<t.length;i+=1)n.append(t[i]);return n.getBlob(e.type)}}"undefined"==typeof Promise&&t(3);var s=Promise;function a(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function u(t,e,r){"function"==typeof e&&t.then(e),"function"==typeof r&&t.catch(r)}function c(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function h(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var l="local-forage-detect-blob-support",f=void 0,d={},p=Object.prototype.toString,y="readonly",b="readwrite";function v(t){return"boolean"==typeof f?s.resolve(f):function(t){return new s(function(e){var r=t.transaction(l,b),n=o([""]);r.objectStore(l).put(n,"key"),r.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},r.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);e(r||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1})}(t).then(function(t){return f=t})}function m(t){var e=d[t.name],r={};r.promise=new s(function(t,e){r.resolve=t,r.reject=e}),e.deferredOperations.push(r),e.dbReady?e.dbReady=e.dbReady.then(function(){return r.promise}):e.dbReady=r.promise}function g(t){var e=d[t.name],r=e.deferredOperations.pop();if(r)return r.resolve(),r.promise}function _(t,e){var r=d[t.name],n=r.deferredOperations.pop();if(n)return n.reject(e),n.promise}function w(t,e){return new s(function(r,n){if(d[t.name]=d[t.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},t.db){if(!e)return r(t.db);m(t),t.db.close()}var o=[t.name];e&&o.push(t.version);var s=i.open.apply(i,o);e&&(s.onupgradeneeded=function(e){var r=s.result;try{r.createObjectStore(t.storeName),e.oldVersion<=1&&r.createObjectStore(l)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),s.onerror=function(t){t.preventDefault(),n(s.error)},s.onsuccess=function(){r(s.result),g(t)}})}function S(t){return w(t,!1)}function E(t){return w(t,!0)}function O(t,e){if(!t.db)return!0;var r=!t.db.objectStoreNames.contains(t.storeName),n=t.version<t.db.version,i=t.version>t.db.version;if(n&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),i||r){if(r){var o=t.db.version+1;o>t.version&&(t.version=o)}return!0}return!1}function x(t){var e=function(t){for(var e=t.length,r=new ArrayBuffer(e),n=new Uint8Array(r),i=0;i<e;i++)n[i]=t.charCodeAt(i);return r}(atob(t.data));return o([e],{type:t.type})}function I(t){return t&&t.__local_forage_encoded_blob}function j(t){var e=this,r=e._initReady().then(function(){var t=d[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return u(r,t,t),r}function k(t,e,r,n){void 0===n&&(n=1);try{var i=t.db.transaction(t.storeName,e);r(null,i)}catch(i){if(n>0&&(!t.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return s.resolve().then(function(){if(!t.db||"NotFoundError"===i.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),E(t)}).then(function(){return function(t){m(t);for(var e=d[t.name],r=e.forages,n=0;n<r.length;n++){var i=r[n];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return t.db=null,S(t).then(function(e){return t.db=e,O(t)?E(t):e}).then(function(n){t.db=e.db=n;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=n}).catch(function(e){throw _(t,e),e})}(t).then(function(){k(t,e,r,n-1)})}).catch(r);r(i)}}var A={_driver:"asyncStorage",_initStorage:function(t){var e=this,r={db:null};if(t)for(var n in t)r[n]=t[n];var i=d[r.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},d[r.name]=i),i.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=j);var o=[];function a(){return s.resolve()}for(var u=0;u<i.forages.length;u++){var c=i.forages[u];c!==e&&o.push(c._initReady().catch(a))}var h=i.forages.slice(0);return s.all(o).then(function(){return r.db=i.db,S(r)}).then(function(t){return r.db=t,O(r,e._defaultConfig.version)?E(r):t}).then(function(t){r.db=i.db=t,e._dbInfo=r;for(var n=0;n<h.length;n++){var o=h[n];o!==e&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}})},_support:function(){try{if(!i)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(t,e){var r=this,n=new s(function(e,n){r.ready().then(function(){k(r._dbInfo,y,function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName),a=s.openCursor(),u=1;a.onsuccess=function(){var r=a.result;if(r){var n=r.value;I(n)&&(n=x(n));var i=t(n,r.key,u++);void 0!==i?e(i):r.continue()}else e()},a.onerror=function(){n(a.error)}}catch(t){n(t)}})}).catch(n)});return a(n,e),n},getItem:function(t,e){var r=this;t=c(t);var n=new s(function(e,n){r.ready().then(function(){k(r._dbInfo,y,function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName),a=s.get(t);a.onsuccess=function(){var t=a.result;void 0===t&&(t=null),I(t)&&(t=x(t)),e(t)},a.onerror=function(){n(a.error)}}catch(t){n(t)}})}).catch(n)});return a(n,e),n},setItem:function(t,e,r){var n=this;t=c(t);var i=new s(function(r,i){var o;n.ready().then(function(){return o=n._dbInfo,"[object Blob]"===p.call(e)?v(o.db).then(function(t){return t?e:(r=e,new s(function(t,e){var n=new FileReader;n.onerror=e,n.onloadend=function(e){var n=btoa(e.target.result||"");t({__local_forage_encoded_blob:!0,data:n,type:r.type})},n.readAsBinaryString(r)}));var r}):e}).then(function(e){k(n._dbInfo,b,function(o,s){if(o)return i(o);try{var a=s.objectStore(n._dbInfo.storeName);null===e&&(e=void 0);var u=a.put(e,t);s.oncomplete=function(){void 0===e&&(e=null),r(e)},s.onabort=s.onerror=function(){var t=u.error?u.error:u.transaction.error;i(t)}}catch(t){i(t)}})}).catch(i)});return a(i,r),i},removeItem:function(t,e){var r=this;t=c(t);var n=new s(function(e,n){r.ready().then(function(){k(r._dbInfo,b,function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName),a=s.delete(t);o.oncomplete=function(){e()},o.onerror=function(){n(a.error)},o.onabort=function(){var t=a.error?a.error:a.transaction.error;n(t)}}catch(t){n(t)}})}).catch(n)});return a(n,e),n},clear:function(t){var e=this,r=new s(function(t,r){e.ready().then(function(){k(e._dbInfo,b,function(n,i){if(n)return r(n);try{var o=i.objectStore(e._dbInfo.storeName),s=o.clear();i.oncomplete=function(){t()},i.onabort=i.onerror=function(){var t=s.error?s.error:s.transaction.error;r(t)}}catch(t){r(t)}})}).catch(r)});return a(r,t),r},length:function(t){var e=this,r=new s(function(t,r){e.ready().then(function(){k(e._dbInfo,y,function(n,i){if(n)return r(n);try{var o=i.objectStore(e._dbInfo.storeName),s=o.count();s.onsuccess=function(){t(s.result)},s.onerror=function(){r(s.error)}}catch(t){r(t)}})}).catch(r)});return a(r,t),r},key:function(t,e){var r=this,n=new s(function(e,n){t<0?e(null):r.ready().then(function(){k(r._dbInfo,y,function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName),a=!1,u=s.openCursor();u.onsuccess=function(){var r=u.result;r?0===t?e(r.key):a?e(r.key):(a=!0,r.advance(t)):e(null)},u.onerror=function(){n(u.error)}}catch(t){n(t)}})}).catch(n)});return a(n,e),n},keys:function(t){var e=this,r=new s(function(t,r){e.ready().then(function(){k(e._dbInfo,y,function(n,i){if(n)return r(n);try{var o=i.objectStore(e._dbInfo.storeName),s=o.openCursor(),a=[];s.onsuccess=function(){var e=s.result;e?(a.push(e.key),e.continue()):t(a)},s.onerror=function(){r(s.error)}}catch(t){r(t)}})}).catch(r)});return a(r,t),r},dropInstance:function(t,e){e=h.apply(this,arguments);var r,n=this.config();if((t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName),t.name){var o=t.name===n.name&&this._dbInfo.db,u=o?s.resolve(this._dbInfo.db):S(t).then(function(e){var r=d[t.name],n=r.forages;r.db=e;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=e;return e});r=t.storeName?u.then(function(e){if(e.objectStoreNames.contains(t.storeName)){var r=e.version+1;m(t);var n=d[t.name],o=n.forages;e.close();for(var a=0;a<o.length;a++){var u=o[a];u._dbInfo.db=null,u._dbInfo.version=r}var c=new s(function(e,n){var o=i.open(t.name,r);o.onerror=function(t){var e=o.result;e.close(),n(t)},o.onupgradeneeded=function(){var e=o.result;e.deleteObjectStore(t.storeName)},o.onsuccess=function(){var t=o.result;t.close(),e(t)}});return c.then(function(t){n.db=t;for(var e=0;e<o.length;e++){var r=o[e];r._dbInfo.db=t,g(r._dbInfo)}}).catch(function(e){throw(_(t,e)||s.resolve()).catch(function(){}),e})}}):u.then(function(e){m(t);var r=d[t.name],n=r.forages;e.close();for(var o=0;o<n.length;o++){var a=n[o];a._dbInfo.db=null}var u=new s(function(e,r){var n=i.deleteDatabase(t.name);n.onerror=n.onblocked=function(t){var e=n.result;e&&e.close(),r(t)},n.onsuccess=function(){var t=n.result;t&&t.close(),e(t)}});return u.then(function(t){r.db=t;for(var e=0;e<n.length;e++){var i=n[e];g(i._dbInfo)}}).catch(function(e){throw(_(t,e)||s.resolve()).catch(function(){}),e})})}else r=s.reject("Invalid arguments");return a(r,e),r}},$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",T="~~local_forage_type~",N=/^~~local_forage_type~([^~]+)~/,R="__lfsc__:",P=R.length,C="arbf",D="blob",F="si08",L="ui08",B="uic8",z="si16",M="si32",U="ur16",V="ui32",H="fl32",q="fl64",Q=P+C.length,Y=Object.prototype.toString;function W(t){var e,r,n,i,o,s=.75*t.length,a=t.length,u=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var c=new ArrayBuffer(s),h=new Uint8Array(c);for(e=0;e<a;e+=4)r=$.indexOf(t[e]),n=$.indexOf(t[e+1]),i=$.indexOf(t[e+2]),o=$.indexOf(t[e+3]),h[u++]=r<<2|n>>4,h[u++]=(15&n)<<4|i>>2,h[u++]=(3&i)<<6|63&o;return c}function J(t){var e,r=new Uint8Array(t),n="";for(e=0;e<r.length;e+=3)n+=$[r[e]>>2],n+=$[(3&r[e])<<4|r[e+1]>>4],n+=$[(15&r[e+1])<<2|r[e+2]>>6],n+=$[63&r[e+2]];return r.length%3==2?n=n.substring(0,n.length-1)+"=":r.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var G={serialize:function(t,e){var r="";if(t&&(r=Y.call(t)),t&&("[object ArrayBuffer]"===r||t.buffer&&"[object ArrayBuffer]"===Y.call(t.buffer))){var n,i=R;t instanceof ArrayBuffer?(n=t,i+=C):(n=t.buffer,"[object Int8Array]"===r?i+=F:"[object Uint8Array]"===r?i+=L:"[object Uint8ClampedArray]"===r?i+=B:"[object Int16Array]"===r?i+=z:"[object Uint16Array]"===r?i+=U:"[object Int32Array]"===r?i+=M:"[object Uint32Array]"===r?i+=V:"[object Float32Array]"===r?i+=H:"[object Float64Array]"===r?i+=q:e(new Error("Failed to get type for BinaryArray"))),e(i+J(n))}else if("[object Blob]"===r){var o=new FileReader;o.onload=function(){var r=T+t.type+"~"+J(this.result);e(R+D+r)},o.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(r){console.error("Couldn't convert value into a JSON string: ",t),e(null,r)}},deserialize:function(t){if(t.substring(0,P)!==R)return JSON.parse(t);var e,r=t.substring(Q),n=t.substring(P,Q);if(n===D&&N.test(r)){var i=r.match(N);e=i[1],r=r.substring(i[0].length)}var s=W(r);switch(n){case C:return s;case D:return o([s],{type:e});case F:return new Int8Array(s);case L:return new Uint8Array(s);case B:return new Uint8ClampedArray(s);case z:return new Int16Array(s);case U:return new Uint16Array(s);case M:return new Int32Array(s);case V:return new Uint32Array(s);case H:return new Float32Array(s);case q:return new Float64Array(s);default:throw new Error("Unkown type: "+n)}},stringToBuffer:W,bufferToString:J};function K(t,e,r,n){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function X(t,e,r,n,i,o){t.executeSql(r,n,i,function(t,s){s.code===s.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],function(t,a){a.rows.length?o(t,s):K(t,e,function(){t.executeSql(r,n,i,o)},o)},o):o(t,s)},o)}var Z={_driver:"webSQLStorage",_initStorage:function(t){var e=this,r={db:null};if(t)for(var n in t)r[n]="string"!=typeof t[n]?t[n].toString():t[n];var i=new s(function(t,n){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(t){return n(t)}r.db.transaction(function(i){K(i,r,function(){e._dbInfo=r,t()},function(t,e){n(e)})},n)});return r.serializer=G,i},_support:"function"==typeof openDatabase,iterate:function(t,e){var r=this,n=new s(function(e,n){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){X(r,i,"SELECT * FROM "+i.storeName,[],function(r,n){for(var o=n.rows,s=o.length,a=0;a<s;a++){var u=o.item(a),c=u.value;if(c&&(c=i.serializer.deserialize(c)),void 0!==(c=t(c,u.key,a+1)))return void e(c)}e()},function(t,e){n(e)})})}).catch(n)});return a(n,e),n},getItem:function(t,e){var r=this;t=c(t);var n=new s(function(e,n){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){X(r,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[t],function(t,r){var n=r.rows.length?r.rows.item(0).value:null;n&&(n=i.serializer.deserialize(n)),e(n)},function(t,e){n(e)})})}).catch(n)});return a(n,e),n},setItem:function(t,e,r){return function t(e,r,n,i){var o=this;e=c(e);var u=new s(function(s,a){o.ready().then(function(){void 0===r&&(r=null);var u=r,c=o._dbInfo;c.serializer.serialize(r,function(r,h){h?a(h):c.db.transaction(function(t){X(t,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,r],function(){s(u)},function(t,e){a(e)})},function(r){if(r.code===r.QUOTA_ERR){if(i>0)return void s(t.apply(o,[e,u,n,i-1]));a(r)}})})}).catch(a)});return a(u,n),u}.apply(this,[t,e,r,1])},removeItem:function(t,e){var r=this;t=c(t);var n=new s(function(e,n){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){X(r,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){n(e)})})}).catch(n)});return a(n,e),n},clear:function(t){var e=this,r=new s(function(t,r){e.ready().then(function(){var n=e._dbInfo;n.db.transaction(function(e){X(e,n,"DELETE FROM "+n.storeName,[],function(){t()},function(t,e){r(e)})})}).catch(r)});return a(r,t),r},length:function(t){var e=this,r=new s(function(t,r){e.ready().then(function(){var n=e._dbInfo;n.db.transaction(function(e){X(e,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],function(e,r){var n=r.rows.item(0).c;t(n)},function(t,e){r(e)})})}).catch(r)});return a(r,t),r},key:function(t,e){var r=this,n=new s(function(e,n){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){X(r,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,r){var n=r.rows.length?r.rows.item(0).key:null;e(n)},function(t,e){n(e)})})}).catch(n)});return a(n,e),n},keys:function(t){var e=this,r=new s(function(t,r){e.ready().then(function(){var n=e._dbInfo;n.db.transaction(function(e){X(e,n,"SELECT key FROM "+n.storeName,[],function(e,r){for(var n=[],i=0;i<r.rows.length;i++)n.push(r.rows.item(i).key);t(n)},function(t,e){r(e)})})}).catch(r)});return a(r,t),r},dropInstance:function(t,e){e=h.apply(this,arguments);var r=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||r.name,t.storeName=t.storeName||r.storeName);var n,i=this;return a(n=t.name?new s(function(e){var n;n=t.name===r.name?i._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?e({db:n,storeNames:[t.storeName]}):e(function(t){return new s(function(e,r){t.transaction(function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(r,n){for(var i=[],o=0;o<n.rows.length;o++)i.push(n.rows.item(o).name);e({db:t,storeNames:i})},function(t,e){r(e)})},function(t){r(t)})})}(n))}).then(function(t){return new s(function(e,r){t.db.transaction(function(n){function i(t){return new s(function(e,r){n.executeSql("DROP TABLE IF EXISTS "+t,[],function(){e()},function(t,e){r(e)})})}for(var o=[],a=0,u=t.storeNames.length;a<u;a++)o.push(i(t.storeNames[a]));s.all(o).then(function(){e()}).catch(function(t){r(t)})},function(t){r(t)})})}):s.reject("Invalid arguments"),e),n}};function tt(t,e){var r=t.name+"/";return t.storeName!==e.storeName&&(r+=t.storeName+"/"),r}function et(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(t){return!0}}()||localStorage.length>0}var rt={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var r in t)e[r]=t[r];return e.keyPrefix=tt(t,this._defaultConfig),et()?(this._dbInfo=e,e.serializer=G,s.resolve()):s.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(t,e){var r=this,n=r.ready().then(function(){for(var e=r._dbInfo,n=e.keyPrefix,i=n.length,o=localStorage.length,s=1,a=0;a<o;a++){var u=localStorage.key(a);if(0===u.indexOf(n)){var c=localStorage.getItem(u);if(c&&(c=e.serializer.deserialize(c)),void 0!==(c=t(c,u.substring(i),s++)))return c}}});return a(n,e),n},getItem:function(t,e){var r=this;t=c(t);var n=r.ready().then(function(){var e=r._dbInfo,n=localStorage.getItem(e.keyPrefix+t);return n&&(n=e.serializer.deserialize(n)),n});return a(n,e),n},setItem:function(t,e,r){var n=this;t=c(t);var i=n.ready().then(function(){void 0===e&&(e=null);var r=e;return new s(function(i,o){var s=n._dbInfo;s.serializer.serialize(e,function(e,n){if(n)o(n);else try{localStorage.setItem(s.keyPrefix+t,e),i(r)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||o(t),o(t)}})})});return a(i,r),i},removeItem:function(t,e){var r=this;t=c(t);var n=r.ready().then(function(){var e=r._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return a(n,e),n},clear:function(t){var e=this,r=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var n=localStorage.key(r);0===n.indexOf(t)&&localStorage.removeItem(n)}});return a(r,t),r},length:function(t){var e=this.keys().then(function(t){return t.length});return a(e,t),e},key:function(t,e){var r=this,n=r.ready().then(function(){var e,n=r._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(n.keyPrefix.length)),e});return a(n,e),n},keys:function(t){var e=this,r=e.ready().then(function(){for(var t=e._dbInfo,r=localStorage.length,n=[],i=0;i<r;i++){var o=localStorage.key(i);0===o.indexOf(t.keyPrefix)&&n.push(o.substring(t.keyPrefix.length))}return n});return a(r,t),r},dropInstance:function(t,e){if(e=h.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var r=this.config();t.name=t.name||r.name,t.storeName=t.storeName||r.storeName}var n,i=this;return a(n=t.name?new s(function(e){t.storeName?e(tt(t,i._defaultConfig)):e(t.name+"/")}).then(function(t){for(var e=localStorage.length-1;e>=0;e--){var r=localStorage.key(e);0===r.indexOf(t)&&localStorage.removeItem(r)}}):s.reject("Invalid arguments"),e),n}},nt=function(t,e){for(var r=t.length,n=0;n<r;){if((i=t[n])===(o=e)||"number"==typeof i&&"number"==typeof o&&isNaN(i)&&isNaN(o))return!0;n++}var i,o;return!1},it=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},ot={},st={},at={INDEXEDDB:A,WEBSQL:Z,LOCALSTORAGE:rt},ut=[at.INDEXEDDB._driver,at.WEBSQL._driver,at.LOCALSTORAGE._driver],ct=["dropInstance"],ht=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ct),lt={description:"",driver:ut.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ft(t,e){t[e]=function(){var r=arguments;return t.ready().then(function(){return t[e].apply(t,r)})}}function dt(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var r in e)e.hasOwnProperty(r)&&(it(e[r])?arguments[0][r]=e[r].slice():arguments[0][r]=e[r])}return arguments[0]}var pt=function(){function t(e){for(var r in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),at)if(at.hasOwnProperty(r)){var n=at[r],i=n._driver;this[r]=i,ot[i]||this.defineDriver(n)}this._defaultConfig=dt({},lt),this._config=dt({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":n(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t&&t.driver)||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,r){var n=new s(function(e,r){try{var n=t._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void r(i);for(var o=ht.concat("_initStorage"),u=0,c=o.length;u<c;u++){var h=o[u],l=!nt(ct,h);if((l||t[h])&&"function"!=typeof t[h])return void r(i)}!function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),r=s.reject(e);return a(r,arguments[arguments.length-1]),r}},r=0,n=ct.length;r<n;r++){var i=ct[r];t[i]||(t[i]=e(i))}}();var f=function(r){ot[n]&&console.info("Redefining LocalForage driver: "+n),ot[n]=t,st[n]=r,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(f,r):f(!!t._support):f(!0)}catch(t){r(t)}});return u(n,e,r),n},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,r){var n=ot[t]?s.resolve(ot[t]):s.reject(new Error("Driver not found."));return u(n,e,r),n},t.prototype.getSerializer=function(t){var e=s.resolve(G);return u(e,t),e},t.prototype.ready=function(t){var e=this,r=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return u(r,t,t),r},t.prototype.setDriver=function(t,e,r){var n=this;it(t)||(t=[t]);var i=this._getSupportedDrivers(t);function o(){n._config.driver=n.driver()}function a(t){return n._extend(t),o(),n._ready=n._initStorage(n._config),n._ready}var c=null!==this._driverSet?this._driverSet.catch(function(){return s.resolve()}):s.resolve();return this._driverSet=c.then(function(){var t=i[0];return n._dbInfo=null,n._ready=null,n.getDriver(t).then(function(t){n._driver=t._driver,o(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(t){return function(){var e=0;return function r(){for(;e<t.length;){var i=t[e];return e++,n._dbInfo=null,n._ready=null,n.getDriver(i).then(a).catch(r)}o();var u=new Error("No available storage method found.");return n._driverSet=s.reject(u),n._driverSet}()}}(i)})}).catch(function(){o();var t=new Error("No available storage method found.");return n._driverSet=s.reject(t),n._driverSet}),u(this._driverSet,e,r),this._driverSet},t.prototype.supports=function(t){return!!st[t]},t.prototype._extend=function(t){dt(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];this.supports(i)&&e.push(i)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=ht.length;t<e;t++)ft(this,ht[t])},t.prototype.createInstance=function(e){return new t(e)},t}(),yt=new pt;e.exports=yt},{3:3}]},{},[4])(4)});let Rt=new It;const Pt=new jt,Ct="storageRankings";try{Nt.originalSupports=Nt.supports,Nt.supports=(t=>{try{const t=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);if(t){const t=parseInt(navigator.userAgent.split("Version/")[1].split(" ")[0],10);return t>10.2}}catch(t){console.error("Error in overrideLocalForageSupport",t)}return Nt.originalSupports(t)}),Nt.config({driver:[Nt.INDEXEDDB,Nt.LOCALSTORAGE],name:"keyval-store",storeName:"keyval"}),window.localStorage&&(Rt=window.localStorage)}catch(t){console.warn("Unable to setup localforage cache.",t.message)}class Dt{static set storage(t){Rt=t}static list(){return s(this,void 0,void 0,function*(){if(void 0!==Nt)return yield Nt.ready(),void(yield Nt.iterate((t,e)=>{console.debug(`${e} --\x3e ${t}`)}));for(let t=0;t<Rt.length;t++){const e=Rt.key(t);console&&e&&console.debug(`${Rt.key(t)} --\x3e ${Rt.getItem(e)}`)}})}static exceedsStorageLimit(t,e){const r=Pt.getStorageSize();return Dt.getLocalStorageSize()+2*((t?t.length:0)+(e?e.length:0))>=r}static getLocalStorageSize(){let t,e=0;for(const r of Object.keys(Rt)){if(!Rt.hasOwnProperty(r))continue;e+=t=2*(localStorage[r].length+r.length)}return e}static put(t,e){return s(this,void 0,void 0,function*(){if(void 0!==Nt)return yield Nt.ready(),yield Nt.setItem(t,e),Promise.resolve(e);if(!Dt.exceedsStorageLimit(t,e)){null!==e&&"object"==typeof e&&(e.dateCached=(new Date).getTime());try{Rt.setItem(t,JSON.stringify(e))}catch(t){console.error(t)}}return Promise.resolve(e)})}static get(t,e=!0){return s(this,void 0,void 0,function*(){if(void 0!==Nt)return yield Nt.ready(),e&&setTimeout(()=>s(this,void 0,void 0,function*(){return Dt.handleStorageRankingUpdate(t)}),0),Nt.getItem(t);const r=Rt.getItem(t);return r?(e&&setTimeout(()=>s(this,void 0,void 0,function*(){return Dt.handleStorageRankingUpdate(t)}),0),Promise.resolve(JSON.parse(r))):null})}static has(t){return s(this,void 0,void 0,function*(){try{const e=yield Dt.get(t),r=Date.now()-864e5;return void 0!==e&&e&&""!==e?e.dateCached?e.dateCached>r:Promise.resolve(!0):Promise.resolve(!1)}catch(e){return console.warn(`An error occurred while looking for ${t} in Cache`,e),Promise.resolve(!1)}})}static remove(t){return s(this,void 0,void 0,function*(){if(void 0!==Nt)return yield Nt.ready(),void(yield Nt.removeItem(t));Rt.removeItem(t)})}static clear(){return s(this,void 0,void 0,function*(){if(void 0!==Nt)return yield Nt.ready(),void(yield Nt.clear());Rt.clear()})}static getStorageRankings(){return s(this,void 0,void 0,function*(){const t=yield Dt.get(Ct,!1);return t&&"string"==typeof t?JSON.parse(t):t&&"object"==typeof t?t:{}})}static handleStorageRankingUpdate(t){return s(this,void 0,void 0,function*(){const e=yield Dt.getStorageRankings();e[t]=e[t]?parseInt(e[t],10)+1:1,Dt.put(Ct,e)})}}class Ft{constructor(t,e={}){this.parts=[],this.url=t,this.parts=Ft.encodeParams(e)}static destruct(t){const e=`${t.protocol}//${t.host}${t.pathname}`,r={};return t.search.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),(t,e,n,i)=>{r[decodeURIComponent(e)]=decodeURIComponent(i)}),{url:e,params:r}}static encodeParams(t){const e=[];if(t)for(const r of Object.keys(t)){const n=t[r];Array.isArray(n)?e.push(`${r}=${encodeURIComponent(n.join(","))}`):e.push(`${r}=${encodeURIComponent(n)}`)}return e}static stringify(t){return Ft.encodeParams(t).join("&")}toString(){return this.url+(-1===this.url.indexOf("?")?"?":"&")+this.parts.join("&")}}var Lt={},Bt=Tt(function(t){!function(){var e,r,n,i=0,o=[];for(a.BUFFER_SIZE=512,a.bin=s,a.test=function(t){if("string"==typeof t)return/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/.test(t)},r=0;r<256;r++)o[r]=(r+256).toString(16).substr(1);function s(){var t=function(t){var o,s,u;if(void 0!==n){if(void 0===e||i+t>a.BUFFER_SIZE)if(i=0,n.getRandomValues)e=new Uint8Array(a.BUFFER_SIZE),n.getRandomValues(e);else{if(!n.randomBytes)throw new Error("Non-standard crypto library");e=n.randomBytes(a.BUFFER_SIZE)}return e.slice(i,i+=t)}for(o=[],r=0;r<t;r++)o.push((s=0,u=255,Math.floor(Math.random()*(u-s))+s));return o}(16);return t[6]=15&t[6]|64,t[8]=63&t[8]|128,t}function a(){var t=s();return o[t[0]]+o[t[1]]+o[t[2]]+o[t[3]]+"-"+o[t[4]]+o[t[5]]+"-"+o[t[6]]+o[t[7]]+"-"+o[t[8]]+o[t[9]]+"-"+o[t[10]]+o[t[11]]+o[t[12]]+o[t[13]]+o[t[14]]+o[t[15]]}"undefined"!=typeof crypto?n=crypto:"undefined"!=typeof window&&void 0!==window.msCrypto&&(n=window.msCrypto),n=n||Lt,t.exports=a}()});const zt=t=>{if("undefined"!=typeof document){const e=`${t}=`,r=document.cookie.split(";");for(let t of r){for(;" "===t.charAt(0);)t=t.substring(1);if(0===t.indexOf(e))return t.substring(e.length,t.length)}}return!1};class Mt{constructor(t={}){this.options=t,this.useCookies=!1,this.config={client_id:"UNDEFINED",client_secret:"UNDEFINED",authorization_url:"https://auth.bullhornstaffing.com/oauth/authorize",token_url:"https://auth.bullhornstaffing.com/oauth/token",login_url:"https://rest.bullhornstaffing.com/rest-services/login",redirect_url:"https://localhost:3000",apiVersion:"*",useCookies:!1},this.config=Object.assign({},this.config,this.options),this.useCookies=t.useCookies||!1,this.options.BhRestToken?Dt.put("BhRestToken",this.config.BhRestToken):this.useCookies=!0,this.options.restUrl&&Dt.put("restUrl",this.config.restUrl)}login(t){return s(this,void 0,void 0,function*(){return t.credential(this.config).then(t=>(Dt.put("BhRestToken",t.BhRestToken),Dt.put("restUrl",t.restUrl),t))})}isLoggedIn(){return s(this,void 0,void 0,function*(){return this.ping()})}static http(t=""){return s(this,void 0,void 0,function*(){const e=zt("UlEncodedIdentity");if(e&&e.length){const r=JSON.parse(decodeURIComponent(e)).sessions.reduce((t,e)=>(t[e.name]=e.value.endpoint,t),{});return Mt._http=Mt.makeCall(t),Mt._http.defaults.baseURL=r.rest,Mt._http.defaults.withCredentials=!0,Mt._http}const r=yield Dt.get("BhRestToken"),n=yield Dt.get("restUrl");return Mt._http=Mt.makeCall(t),r&&n&&(Mt._http.defaults.baseURL=n,Mt._http.defaults.params={BhRestToken:r},Mt._http.defaults.withCredentials=!1),Mt._http})}static makeCall(t=""){const e=r.create({paramsSerializer:t=>Ft.stringify(t)});return Mt.httpInitialized||(Mt.httpInitialized=!0),e.interceptors.response.use(t=>{const e=t.config._timing||void 0;return Mt.trackingCallback&&e&&Mt.trackingCallback(e.url,(new Date).getTime()-e.start),t},t=>s(this,void 0,void 0,function*(){const e=t.response.config._timing||{};return Mt.trackingCallback&&e&&Mt.trackingCallback(e.url,(new Date).getTime()-e.start),401===t.response.status&&Mt.unauthorized.next(t),Promise.reject(t)})),e.interceptors.request.use(e=>(e._timing={start:(new Date).getTime(),url:(e.url||"").replace(e.baseURL||"","").split("?")[0]},e.headers.uniqueCallId=Bt(),""!==t&&(e.headers.highLevelCallStack=t),e)),e}ping(){return s(this,void 0,void 0,function*(){return(yield Mt.http()).get("ping")})}}Mt.unauthorized=new e.Subject,Mt._http=r.create({paramsSerializer:t=>Ft.stringify(t)}),Mt.httpInitialized=!1;class Ut{constructor(t,e=""){this.entity=t,this.memory={},this.fields=[],this.layouts=[],this.tracks=[],this.sectionHeaders=[],this.allFieldsLoaded=!1,this.parameters={fields:"*",meta:"full"},this.initialized=this.initialize(e)}initialize(t=""){return s(this,void 0,void 0,function*(){this.http=yield Mt.http(t);const e=yield Dt.get(this.endpoint);e?this.parse(e):this.parse({fields:[],layouts:[]})})}get endpoint(){return`meta/${this.entity}`}setFieldsOnLayout(t,e){if(t&&t.layouts){const r=t.layouts.findIndex(t=>t.name===e);return r>-1&&(t.layouts[r].fields=t.fields.map(t=>t.name)),r}return-1}style(t="full"){return this.parameters.meta=t,this}params(t){return this.parameters=Object.assign({},this.parameters,t),this}get(t,e){return s(this,void 0,void 0,function*(){yield this.initialized;const r=this.missing(t);if(r.length||e){this.parameters.fields=r.join(","),e&&(this.parameters.layout=e);const n=(yield this.http.get(this.endpoint,{params:this.parameters})).data;return this.allFieldsLoaded="*"===t[0],this.parse(n),this.label=n.label,this.extract(t)}return this.extract(t)})}getTracks(){return s(this,void 0,void 0,function*(){return yield this.initialized,this.memory?this.tracks:(yield this.get(["*"]),this.tracks)})}getFields(){return s(this,void 0,void 0,function*(){return yield this.initialized,this.memory?this.fields:(yield this.get(["*"]),this.fields)})}getAllLayouts(){return s(this,void 0,void 0,function*(){if(yield this.initialized,this.allFieldsLoaded)return this.layouts;const t=yield this.http.get(this.endpoint,{params:{meta:"full",includeLayoutFields:!0}});return this.parse(t.data),t.data.layouts})}getFull(t,e){return s(this,void 0,void 0,function*(){yield this.initialized;const r=yield this.get(t),n=e?yield this.getByLayout(e):[],i=yield Dt.get(this.endpoint);return i.fields=[...r,...n],i})}getByLayout(t,e=!0){return s(this,void 0,void 0,function*(){yield this.initialized;const r=this.layouts.find(e=>e.name===t);if(!r||!r.hasOwnProperty("fields")){this.parameters.layout=t,delete this.parameters.fields;const r=(yield this.http.get(this.endpoint,{params:this.parameters})).data,n=this.setFieldsOnLayout(r,t);return this.label=r.label,this.parse(r,e),n>-1?this.layouts.splice(n,1,{name:t,label:t,enabled:!0,fields:r.layouts[n].fields}):this.layouts.push({name:t,label:t,enabled:!0,fields:r.fields.map(t=>t.name)}),Promise.resolve(r.fields)}return this.get(r.fields)})}parse(t,e=!1){if(t){if(t&&t.fields){for(const e of t.fields){this.memory.hasOwnProperty(e.name)||Object.defineProperty(this,e.name,{get(){return this.memory[e.name]},set(t){this.memory[e.name]=t},configurable:!0,enumerable:!0}),this.fields.find(t=>t.name===e.name)||this.fields.push(e),this.memory[e.name]=e}this.fields.sort((t,e)=>{const r=t.sortOrder?t.sortOrder:t.name,n=e.sortOrder?e.sortOrder:e.name;return r>n?1:n>r?-1:0})}if(t&&t.layouts)for(const e of t.layouts){const t=this.layouts.find(t=>t.name===e.name);t?e.fields&&(t.fields=e.fields):this.layouts.push(e)}t&&t.trackTrigger&&(this.trackTrigger=t.trackTrigger,this.tracks=t.tracks),t&&t.sectionHeaders&&(this.sectionHeaders=t.sectionHeaders),t.fields=e?t.fields:this.fields,t.layouts=this.layouts,t.trackTrigger=this.trackTrigger,t.tracks=this.tracks,t.sectionHeaders=this.sectionHeaders,t.allFieldsLoaded=t.allFieldsLoaded||this.allFieldsLoaded,this.allFieldsLoaded=t.allFieldsLoaded,Dt.put(this.endpoint,t)}}missing(t){if(!this.memory)return t;if(t&&"*"===t[0]&&this.allFieldsLoaded)return[];const e=[];for(const r of t){const t=this._clean(r);this.memory[t]||e.push(t)}return e}_clean(t){return t.split(".")[0].split("[")[0].split("(")[0]}extract(t){if(!this.memory)return[];if(t&&"*"===t[0])return Object.values(this.memory);const e=[];for(const r of t){const t=this._clean(r),n=this.memory[t];n&&"id"===n.name?e.unshift(n):e.push(n)}return e}static validate(){return s(this,void 0,void 0,function*(){const t=(yield(yield Mt.http()).get("/meta")).data;if(t)for(const e of t)if(e.dateLastModified){const t=yield Dt.get(`meta/${e.entity}`);t&&t.dateLastModified!==e.dateLastModified&&Dt.remove(`meta/${e.entity}`)}else Dt.remove(`meta/${e.entity}`);return!0})}static preload(t,e=""){return s(this,void 0,void 0,function*(){const r=new Ut(t,e);return Promise.all([r.get(["*"]),r.getAllLayouts()])})}}Ut.BASIC="basic",Ut.FULL="full",Ut.TRACK="track";class Vt{constructor(t,e=""){this._fields=[],this.type=t,this.endpoint=`entity/${this.type}`,this.meta=new Ut(this.type,e),this.parameters={fields:this._fields||["id"]},this.initialized=this.initialize(e)}initialize(t=""){return s(this,void 0,void 0,function*(){this.http=yield Mt.http(t)})}fields(...t){const e=Array.isArray(t[0])?t[0]:t;for(const t of e)this._fields.includes(t)||this._fields.push(t);return this.parameters||(this.parameters={}),this.parameters.fields=this._fields,this}params(t){return this.parameters=Object.assign({},this.parameters,t),this}get(t){return s(this,void 0,void 0,function*(){yield this.initialized;const[e,r]=yield Promise.all([this.http.get(`${this.endpoint}/${t}`,{params:this.parameters}),this.meta.getFull(this.parameters.fields,this.parameters.layout)]),n=e.data;return n.meta=r,n})}edit(t){return s(this,void 0,void 0,function*(){yield this.initialized;const e=Object.assign({},this.parameters,{layout:"RecordEdit"});delete e.fields;const[r,n]=yield Promise.all([this.http.get(`${this.endpoint}/${t}`,{params:e}),this.meta.getFull(this.parameters.fields,"RecordEdit")]),i=r.data;return i.meta=n,i})}many(t,e,r,n={}){return s(this,void 0,void 0,function*(){return yield this.initialized,(yield this.http.get(`${this.endpoint}/${r.id}/${t}`,{params:Object.assign({fields:e,showTotalMatched:!0},n)})).data})}save(t){return s(this,void 0,void 0,function*(){return yield this.initialized,t&&t.id?this.http.post(`${this.endpoint}/${t.id}`,t):this.http.put(this.endpoint,t)})}delete(t){return s(this,void 0,void 0,function*(){return yield this.initialized,this.http.delete(`${this.endpoint}${t}`)})}}class Ht{constructor(){throw new TypeError("Cannot invoke the constructor function of a static class.")}static toSearchSyntax(t){const e=[];for(const r of Object.keys(t)){const n=t[r];"or"===r?e.push(`(${Ht.toSearchSyntax(n).replace(/ AND /g," OR ")})`):e.push(Ht.parseSearchValue(r,n))}return e.join(" AND ")}static parseSearchValue(t,e){const r=[];if(Array.isArray(e))r.push(`${t}:${Ht.writeLuceneValues(e)}`);else if(e instanceof Object){if((e.min||e.max)&&r.push(`${t}:[${Ht.writeLuceneValue(e.min||"*")} TO ${Ht.writeLuceneValue(e.max||"*")}]`),e.any&&Array.isArray(e.any)){const n=e.any.map(t=>~`${t}`.trim().indexOf(" ")?`"${t}"`:t);r.push(`${t}:(${n.join(" ")})`)}if(e.all&&Array.isArray(e.all)){const n=e.all.map(t=>~`${t}`.trim().indexOf(" ")?`"${t}"`:t);r.push(`${t}:(${n.join(" AND ")})`)}if(e.not&&r.push(`NOT (${Ht.parseSearchValue(t,e.not)})`),e.like&&r.push(`${t}:(${e.like}*)`),e.lookup&&r.push(`${t}:"^(${Ht.toQuerySyntax(e.lookup)})"`),e.with&&r.push(`${t}.id:"[0 TO *]"`),e.without&&r.push(`-${t}.id:"[0 TO *]"`),e.or){const n={};n[t]=e.or,r.push(`(${Ht.toSearchSyntax(n)})`.replace(" AND "," OR "))}null!==e.memberOf&&void 0!==e.memberOf&&Array.isArray(e.memberOf)&&r.push(`${t}.id: (${e.memberOf.join(" ")})`);for(const n of Object.keys(e))if(["min","max","any","all","not","or","like","lookup","with","without","isNull","memberOf"].indexOf(n)<0){const i=e[n];r.push(Ht.parseSearchValue(`${t}.${n}`,i))}}else e.indexOf&&~e.indexOf("*")?r.push(`${t}:(${e})`):r.push(`${t}:${Ht.writeLuceneValue(e)}`);return r.join(" AND ")}static writeLuceneValue(t){return t instanceof Date?t.toISOString().split(".")[0].replace(/[-:T]/gi,""):"number"==typeof t||"boolean"==typeof t?`${t}`:"*"===t?`${t}`:`"${t}"`}static writeLuceneValues(t){return"number"==typeof t[0]||"boolean"==typeof t[0]?`(${t.join(" ")})`:`("${t.join('" "')}")`}static toQuerySyntax(t){const e=[];for(const r of Object.keys(t)){const n=t[r];"or"===r?e.push(`(${Ht.toQuerySyntax(n).replace(/ AND /g," OR ")})`):e.push(Ht.parseQueryValue(r,n))}return e.join(" AND ")}static parseQueryValue(t,e,r=!1){const n=[],i=r?" NOT IN ":" IN ",o=r?"<>":"=",s=r?"<":">=",a=r?">=":"<";if(Array.isArray(e))n.push(`${t}${i}(${Ht.writeQueryValues(e)})`);else if(e instanceof Object){if("boolean"==typeof e.isNull){const r=e.isNull?"IS NULL":"IS NOT NULL";n.push(`${t} ${r}`)}if(null!==e.min&&void 0!==e.min&&n.push(`${t}${s}${Ht.writeQueryValue(e.min)}`),null!==e.max&&void 0!==e.max&&n.push(`${t}${a}${Ht.writeQueryValue(e.max)}`),e.any&&Array.isArray(e.any)&&n.push(`${t}${i}(${Ht.writeQueryValues(e.any)})`),e.all&&Array.isArray(e.all)&&n.push(`${t}${i}(${Ht.writeQueryValues(e.all)})`),null!==e.not&&void 0!==e.not&&n.push(Ht.parseQueryValue(t,e.not,!0)),null!==e.like&&void 0!==e.like&&n.push(`${t} like '%${e.like}%'`),null!==e.lookup&&void 0!==e.lookup){const r={};r[t]=e.lookup,n.push(Ht.toQuerySyntax(r))}if(null!==e.with&&void 0!==e.with&&n.push(`${t} IS NOT EMPTY`),null!==e.without&&void 0!==e.without&&n.push(`${t} IS EMPTY`),null!==e.or&&void 0!==e.or){const r={};r[t]=e.or,n.push(Ht.toQuerySyntax(r).replace("AND","OR"))}if(null!==e.memberOf&&void 0!==e.memberOf&&Array.isArray(e.memberOf)){const i=[];for(const n of e.memberOf)r?i.push(`${n} NOT MEMBER OF ${t}`):i.push(`${n} MEMBER OF ${t}`);r?n.push(`(${i.join(" AND ")})`):n.push(`(${i.join(" OR ")})`)}for(const r of Object.keys(e))if(["min","max","any","all","not","or","like","lookup","with","without","isNull","memberOf"].indexOf(r)<0){const i=e[r];n.push(Ht.parseQueryValue(`${t}.${r}`,i))}}else n.push(`${t}${o}${Ht.writeQueryValue(e)}`);return n.join(" AND ")}static writeQueryValue(t){return t instanceof Date?t.getTime():"number"==typeof t||"boolean"==typeof t?`${t}`:`'${t.replace(/\*/g,"")}'`}static writeQueryValues(t){return"number"==typeof t[0]||"boolean"==typeof t[0]?`${t.join(",")}`:`'${t.join("','")}'`}}class qt{constructor(t,e=""){this.entity=t,this.records=[],this.parameters={fields:["id"],orderBy:["-dateAdded"],start:0,count:10},this._page=0,this.initialized=this.initialize(e),this.meta=new Ut(t,e)}initialize(t=""){return s(this,void 0,void 0,function*(){this.http=yield Mt.http(t)})}get endpoint(){return this._endpoint||`query/${this.entity}`}set endpoint(t){this._endpoint=t}get total(){return(()=>s(this,void 0,void 0,function*(){return yield this.initialized,this._lastResponse&&this._lastResponse.total?Promise.resolve(this._lastResponse.total):this.http.get(this.endpoint,{params:Object.assign({fields:"id",count:0},this.parameters)}).then(t=>t.data).then(t=>t.total||0)}))()}get snapshot(){return this._lastResponse}fields(...t){return this.parameters.fields=t[0]instanceof Array?t[0]:t,this}sort(...t){return this.parameters.orderBy=t[0]instanceof Array?t[0]:t,this}where(t){return this.query(Ht.toQuerySyntax(t))}query(t){return this.parameters.where=t,this}count(t){return this.parameters.count=t,this}page(t){return this._page=t,this.parameters.start=this.parameters.count*t,this}nextpage(){return s(this,void 0,void 0,function*(){return this.page(++this._page).run(!0)})}params(t){return this.parameters=Object.assign({},this.parameters,t),this}get(t){return s(this,void 0,void 0,function*(){return this.run(t)})}run(t){return s(this,void 0,void 0,function*(){return yield this.initialized,Promise.all([this.http.get(this.endpoint,{params:this.parameters}),this.meta.getFull(this.parameters.fields,this.parameters.layout)]).then(([t,e])=>[t.data,e]).then(([e,r])=>{this._lastResponse=e;const n=e.data;return this.records=t?this.records.concat(n):n,e.meta=r,e})})}then(t,e){return s(this,void 0,void 0,function*(){return this.run(!1).then(t,e)})}}class Qt extends qt{constructor(t,e=""){super(t,e),this.parameters={fields:["id"],sort:["-dateAdded"],start:0,count:10}}get endpoint(){return this._endpoint||`search/${this.entity}`}set endpoint(t){this._endpoint=t}sort(...t){return this.parameters.sort=t[0]instanceof Array?t[0]:t,this}where(t){return this.query(Ht.toSearchSyntax(t))}query(t){return this.parameters.query=t,this}then(t,e){return s(this,void 0,void 0,function*(){return this.run(!1).then(t,e)})}}class Yt{validateCode(t){return s(this,void 0,void 0,function*(){return r.post(`${this.config.token_url}?grant_type=authorization_code&code=${t}&client_id=${this.config.client_id}&client_secret=${this.config.client_secret}`).then(t=>t.data)})}restLogin(t){return s(this,void 0,void 0,function*(){const e=this.config.ttl?`&ttl=${this.config.ttl}`:"";return r.post(`${this.config.login_url}?version=*&access_token=${t}${e}`).then(t=>t.data)})}}const Wt=Symbol("EMPTY");class Jt extends e.Subject{constructor(t=Wt){super(),this._value=t}get snapshot(){return this.getValue()}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&this.hasValue()&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new e.ObjectUnsubscribedError;return this._value}hasValue(){return!this.hasError&&(!this.closed&&this._value!==Wt)}next(t){super.next(this._value=t)}once(){return this.pipe((t=1,function(e){return 0===t?X():e.lift(new rt(t))}));var t}}var Gt=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isFunction=function(t){return"function"==typeof t}});$t(Gt);Gt.isFunction;var Kt=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=!1;e.config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){var e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else r&&console.log("RxJS: Back to a better error behavior. Thank you. <3");r=t},get useDeprecatedSynchronousErrorHandling(){return r}}});$t(Kt);Kt.config;var Xt=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.hostReportError=function(t){setTimeout(function(){throw t},0)}});$t(Xt);Xt.hostReportError;var Zt=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.empty={closed:!0,next:function(t){},error:function(t){if(Kt.config.useDeprecatedSynchronousErrorHandling)throw t;Xt.hostReportError(t)},complete:function(){}}});$t(Zt);Zt.empty;var te=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isArray=Array.isArray||function(t){return t&&"number"==typeof t.length}});$t(te);te.isArray;var ee=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isObject=function(t){return null!==t&&"object"==typeof t}});$t(ee);ee.isObject;var re=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}();e.UnsubscriptionError=r});$t(re);re.UnsubscriptionError;var ne=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var r=this._parentOrParents,i=this._unsubscribe,o=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof t)r.remove(this);else if(null!==r)for(var s=0;s<r.length;++s){r[s].remove(this)}if(Gt.isFunction(i))try{i.call(this)}catch(t){e=t instanceof re.UnsubscriptionError?n(t.errors):[t]}if(te.isArray(o)){s=-1;for(var a=o.length;++s<a;){var u=o[s];if(ee.isObject(u))try{u.unsubscribe()}catch(t){e=e||[],t instanceof re.UnsubscriptionError?e=e.concat(n(t.errors)):e.push(t)}}}if(e)throw new re.UnsubscriptionError(e)}},t.prototype.add=function(e){var r=e;if(!e)return t.EMPTY;switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof t)){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=r._parentOrParents;if(null===i)r._parentOrParents=this;else if(i instanceof t){if(i===this)return r;r._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return r;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[r]:o.push(r),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.EMPTY=((e=new t).closed=!0,e),t}();function n(t){return t.reduce(function(t,e){return t.concat(e instanceof re.UnsubscriptionError?e.errors:e)},[])}e.Subscription=r});$t(ne);ne.Subscription;var ie=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.rxSubscriber="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),e.$$rxSubscriber=e.rxSubscriber});$t(ie);ie.rxSubscriber,ie.$$rxSubscriber;var oe=Tt(function(t,e){var r,n=kt&&kt.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(r,n,i){var s=t.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,arguments.length){case 0:s.destination=Zt.empty;break;case 1:if(!r){s.destination=Zt.empty;break}if("object"==typeof r){r instanceof e?(s.syncErrorThrowable=r.syncErrorThrowable,s.destination=r,r.add(s)):(s.syncErrorThrowable=!0,s.destination=new o(s,r));break}default:s.syncErrorThrowable=!0,s.destination=new o(s,r,n,i)}return s}return n(e,t),e.prototype[ie.rxSubscriber]=function(){return this},e.create=function(t,r,n){var i=new e(t,r,n);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(ne.Subscription);e.Subscriber=i;var o=function(t){function e(e,r,n,i){var o,s=t.call(this)||this;s._parentSubscriber=e;var a=s;return Gt.isFunction(r)?o=r:r&&(o=r.next,n=r.error,i=r.complete,r!==Zt.empty&&(a=Object.create(r),Gt.isFunction(a.unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=o,s._error=n,s._complete=i,s}return n(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;Kt.config.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=Kt.config.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):Xt.hostReportError(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;Xt.hostReportError(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};Kt.config.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),Kt.config.useDeprecatedSynchronousErrorHandling)throw t;Xt.hostReportError(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!Kt.config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return Kt.config.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(Xt.hostReportError(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(i);e.SafeSubscriber=o});$t(oe);oe.Subscriber,oe.SafeSubscriber;var se=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.canReportError=function(t){for(;t;){var e=t,r=e.closed,n=e.destination,i=e.isStopped;if(r||i)return!1;t=n&&n instanceof oe.Subscriber?n:null}return!0}});$t(se);se.canReportError;var ae=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.toSubscriber=function(t,e,r){if(t){if(t instanceof oe.Subscriber)return t;if(t[ie.rxSubscriber])return t[ie.rxSubscriber]()}return t||e||r?new oe.Subscriber(t,e,r):new oe.Subscriber(Zt.empty)}});$t(ae);ae.toSubscriber;var ue=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.observable="function"==typeof Symbol&&Symbol.observable||"@@observable"});$t(ue);ue.observable;var ce=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.noop=function(){}});$t(ce);ce.noop;var he=Tt(function(t,e){function r(t){return t?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:ce.noop}Object.defineProperty(e,"__esModule",{value:!0}),e.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(t)},e.pipeFromArray=r});$t(he);he.pipe,he.pipeFromArray;var le=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,i=ae.toSubscriber(t,e,r);if(n?i.add(n.call(i,this.source)):i.add(this.source||Kt.config.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),Kt.config.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){Kt.config.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),se.canReportError(t)?t.error(e):console.warn(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=n(e))(function(e,n){var i;i=r.subscribe(function(e){try{t(e)}catch(t){n(t),i&&i.unsubscribe()}},n,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[ue.observable]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:he.pipeFromArray(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=n(t))(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(e){return new t(e)},t}();function n(t){if(t||(t=Kt.config.Promise||Promise),!t)throw new Error("no Promise impl found");return t}e.Observable=r});$t(le);le.Observable;var fe=Tt(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isObservable=function(t){return!!t&&(t instanceof le.Observable||"function"==typeof t.lift&&"function"==typeof t.subscribe)}});$t(fe);var de=fe.isObservable;function pe(t,r=!0){return xt(t).defined?new e.Observable(n=>{let i=e.combineLatest([ye("id",t),ye("fields",t),ye("layout",t),ye("meta",t),ye("showEditable",t),ye("showReadOnly",t),ye("executeFormTriggers",t),ye("params",t)]);r&&(i=i.pipe(M(0))),i.subscribe(([t,e,r,i,o,s,a,u])=>{const c={};void 0!==t&&(c.id=t),void 0!==e&&(c.fields=e),void 0!==r&&(c.layout=r),void 0!==i&&(c.meta=i),void 0!==o&&(c.showEditable=o),void 0!==s&&(c.showReadOnly=s),void 0!==a&&(c.executeFormTriggers=a),void 0!==u&&(c.params=u),n.next(c)})}):e.of(null)}function ye(t,r){return de(r[t])?r[t]:Et(r).have(t)?new e.Observable(e=>{e.next(r[t])}):new e.Observable(t=>{t.next(void 0)})}class be extends Jt{constructor(t,e={},r,n=""){super(r),this._fields=[],this.broker=wt.getInstance(),this.type=t,this.$entity=new Vt(this.type,n),pe(e).subscribe(t=>{if(t)for(const e of Object.keys(t))switch(e){case"fields":this.fields(t.fields);break;case"layout":this.$entity.params({layout:t.layout});break;case"meta":this.$entity.meta.style(t.meta);break;case"showEditable":this.$entity.params({showEditable:t.showEditable});break;case"showReadOnly":this.$entity.params({showReadOnly:t.showReadOnly});break;case"executeFormTriggers":this.$entity.params({executeFormTriggers:t.executeFormTriggers});break;case"params":this.$entity.params(t.params);break;case"id":this.get(t.id);break;default:console.warn(`Unknown key in params: ${e}`)}}),this.hasValue()&&(this.fields(Object.keys(this.value)),this._setUpObservable(this.value))}fields(...t){const e=Array.isArray(t[0])?t[0]:t;for(const t of e)this._fields.includes(t)||(this._proxy(t),this._fields.push(t));return this.$entity.fields(...t),this}_proxy(t){const e=new Jt(this.value&&this.value[t]);Object.defineProperty(this,t,{get:()=>e,set(r){this.patch({[t]:r}),e.next(r)},configurable:!0,enumerable:!0})}params(t){return t.hasOwnProperty("fields")&&(this.fields(t.fields),delete t.fields),this.$entity.params(t),this}set(t){return this.next(t),this.fields(Object.keys(t)),this.broker.emit(`${this.type}:${t.id}:value`,t),this}patch(t,e=!1){const r=this.value||{},n=Object.assign({},r,t);return this.next(n),this.fields(Object.keys(n)),e||this.broker.emit(`${this.type}:${n.id}:value`,n),this}get(t){return this.$entity.get(t).then(t=>(this.descriptor=t.meta,this.patch(t.data),this._setUpObservable(this.getValue()),t)),this}many(t,e){return this.$entity.many(t,e,this.value).then(e=>(this._fields.includes(t)||(this._proxy(t),this._fields.push(t)),this.value[t]=e,this.patch({property:e}),this._setUpObservable(this.getValue()),e)),this}save(){return s(this,void 0,void 0,function*(){return this.$entity.save(this.value).then(t=>{const e=t.data;return this.patch({id:e.changedEntityId}),this._setUpObservable(this.getValue()),t})})}remove(){return s(this,void 0,void 0,function*(){return this.$entity.delete(this.value.id)})}_setUpObservable(t){t&&t.id&&this.broker.on(`${this.type}:${t.id}:value`).subscribe(t=>{this.patch(t,!0)})}}function ve(t,r=!0){return xt(t).defined?new e.Observable(n=>{let i=e.combineLatest([ye("fields",t),ye("layout",t),ye("meta",t),ye("orderBy",t),ye("startAt",t),ye("limitTo",t),ye("filter",t),ye("params",t)]);r&&(i=i.pipe(M(0))),i.subscribe(([t,e,r,i,o,s,a,u])=>{const c={};void 0!==t&&(c.fields=t),void 0!==e&&(c.layout=e),void 0!==r&&(c.meta=r),void 0!==i&&(c.orderBy=i),void 0!==o&&(c.startAt=o),void 0!==s&&(c.limitTo=s),void 0!==a&&(c.filter=a),void 0!==u&&(c.params=u),n.next(c)})}):e.of(null)}class me extends Jt{constructor(t,e={},r,n=""){super(r),this.broker=wt.getInstance(),this.type=t,this.$ref=new be(this.type,{}),this.$list=this.getSearcher(this.type,n),ve(e).subscribe(t=>{if(t)for(const e of Object.keys(t))switch(e){case"fields":this.$list.fields(t.fields);break;case"layout":this.$list.params({layout:t.layout});break;case"meta":this.$list.meta.style(t.meta);break;case"orderBy":this.$list.sort(t.orderBy);break;case"startAt":this.$list.params({start:t.startAt});break;case"limitTo":this.$list.count(t.limitTo||25);break;case"filter":this.$list.where(t.filter);break;case"params":this.$list.params(t.params);break;default:console.warn(`Unknown key in params: ${e}`)}this.$list.then(t=>{this.descriptor=t.meta,this.$latest=t,this.next(t.data)},t=>{this.error(t)})}),this._setUpObservable()}getSearcher(t,e=""){return["Candidate","ClientContact","ClientCorporation","JobOrder","Lead","Opportunity","Placement","JobSubmission","Note","UserMessage"].indexOf(t)>=0?new Qt(this.type,e):new qt(this.type,e)}get lastAdded(){return this.$ref}get info(){return{total:this.$latest.total,messages:this.$latest.messages,start:this.$latest.start,count:this.$latest.count}}findById(t){const e=this.getValue().find(e=>e.id===t);return e||new be(this.type,{id:t})}push(t){return s(this,void 0,void 0,function*(){return this.$ref.set(t).save().then(this._eventHook("child_added"))})}update(t,e){return s(this,void 0,void 0,function*(){return this._checkOperationCases(t,{keyCase:()=>s(this,void 0,void 0,function*(){return this.findById(t).patch(e).save()}),entityCase:()=>s(this,void 0,void 0,function*(){return t.patch(e).save()})}).then(this._eventHook("child_updated"))})}remove(t){return s(this,void 0,void 0,function*(){return this._checkOperationCases(t,{keyCase:()=>s(this,void 0,void 0,function*(){return this.findById(t).remove()}),entityCase:()=>s(this,void 0,void 0,function*(){return t.remove()})}).then(this._eventHook("child_removed"))})}_setUpObservable(){this.broker.on(`${this.type}:*`).subscribe(()=>{this.$list.then(t=>{this.descriptor=t.meta,this.next(t.data)})})}_eventHook(t){return e=>(this.broker.emit(`${this.type}:${e.changedEntityId}:value`,e.data),this.broker.emit(`${this.type}:${t}`,e.data),e)}_checkOperationCases(t,e){return s(this,void 0,void 0,function*(){if(xt(t).aNumber)return e.keyCase();if(xt(t).aTypeOf(be))return e.entityCase();throw new Error(`Method requires a key or reference. Got: ${typeof t}`)})}}me.useSearch=!1,t.EntityMessageBroker=wt,t.EntityService=Vt,t.EntitySubscription=class{constructor(t,e=[]){this.subscriptionId=t,this.types=e,this.subscriptionType="entity",this.eventTypes=["INSERTED","UPDATED","DELETED"],this.broker=wt.getInstance(),this._lastRequestId=0,this._setUpObservable().catch(()=>console.error("Error in Subscription")),this.initialized=this.initialize()}initialize(){return s(this,void 0,void 0,function*(){this.http=yield Mt.http()})}get endpoint(){return`event/subscription/${this.subscriptionId}`}subscribe(){return s(this,void 0,void 0,function*(){return yield this.initialized,(yield this.http.put(this.endpoint,{params:{type:this.subscriptionType,eventTypes:this.eventTypes,names:this.types}})).data})}unsubscribe(){return s(this,void 0,void 0,function*(){return yield this.initialized,(yield this.http.delete(this.endpoint)).data})}get(){return s(this,void 0,void 0,function*(){yield this.initialized;const t=yield this.http.get(this.endpoint,{params:{maxEvents:100}});return this._lastRequestId=t.data.requestId,t.data.events})}_setUpObservable(){return s(this,void 0,void 0,function*(){yield this.unsubscribe(),yield this.subscribe(),setInterval(()=>s(this,void 0,void 0,function*(){const t=yield this.get();for(const e of t)this.broker.emit(`${e.entityName}:${e.entityId}:invalidate`,e)}),5e3)})}},t.MetaService=Ut,t.QueryService=qt,t.OptionsService=class{constructor(t){this.optionType=t,this.records=[],this.parameters={filter:void 0,start:0,count:10},this._page=0,this.initialized=this.initialize()}initialize(){return s(this,void 0,void 0,function*(){this.http=yield Mt.http()})}get endpoint(){return this._endpoint||`options/${this.optionType}`}set endpoint(t){this._endpoint=t}get snapshot(){return this._lastResponse}filter(t){return this.parameters.filter=t,this}count(t){return this.parameters.count=t,this}page(t){return this._page=t,this.parameters.start=this.parameters.count*t,this}nextpage(){return s(this,void 0,void 0,function*(){return this.page(++this._page).run(!0)})}params(t){return this.parameters=Object.assign({},this.parameters,t),this}get(t){return s(this,void 0,void 0,function*(){return this.run(t)})}run(t){return s(this,void 0,void 0,function*(){return yield this.initialized,this.http.get(this.endpoint,{params:this.parameters}).then(t=>t.data).then(e=>{this._lastResponse=e;const r=e.data;return this.records=t?this.records.concat(r):r,e}).catch(t=>t)})}then(t,e){return s(this,void 0,void 0,function*(){return this.run(!1).then(t,e)})}},t.LookupService=class{constructor(t,e={}){this.types=t,this.options=e,this.records=[],this.parameters={entity:[],filter:void 0,count:10,isCountPerEntity:!0},this.initialized=this.initialize(),this.params(Object.assign({entity:this.types},this.options))}initialize(){return s(this,void 0,void 0,function*(){this.http=yield Mt.http()})}get endpoint(){return this._endpoint||"lookup/expanded"}set endpoint(t){this._endpoint=t}filter(t){return this.parameters.filter=t,this}count(t){return this.parameters.count=t,this}params(t){return this.parameters=Object.assign({},this.parameters,t),this}get(){return s(this,void 0,void 0,function*(){return this.run()})}run(){return s(this,void 0,void 0,function*(){return yield this.initialized,this.http.get(this.endpoint,{params:this.parameters}).then(t=>t.data).then(t=>(this.records=t,t)).catch(t=>t)})}then(t,e){return s(this,void 0,void 0,function*(){return this.run().then(t,e)})}},t.SearchService=Qt,t.SettingService=class{constructor(t=""){this.allSettingsAndEntitlementsEndpoint="services/Settings/allEntitlementsAndSettings",this.initialized=this.initialize(t)}initialize(t=""){return s(this,void 0,void 0,function*(){this.http=yield Mt.http(t)})}getSettings(t){return s(this,void 0,void 0,function*(){return yield this.initialized,(yield this.http.get(`settings/${t.join()}`)).data})}getEntitlements(t){return s(this,void 0,void 0,function*(){return yield this.initialized,(yield this.http.get(`entitlements/${t}`)).data})}getAllSettingsAndEntitlements(t=!1){return s(this,void 0,void 0,function*(){let e;return yield this.initialized,t&&(yield Dt.has(this.allSettingsAndEntitlementsEndpoint))?e=yield Dt.get(this.allSettingsAndEntitlementsEndpoint):(e=(yield this.http.get(this.allSettingsAndEntitlementsEndpoint)).data,t&&Dt.put(this.allSettingsAndEntitlementsEndpoint,e)),e&&e.dashboardEntitlements&&e.entitlements&&(e.entitlements.Dashboard=e.dashboardEntitlements),e})}},t.Staffing=Mt,t.StaffingOAuthBaseProvider=Yt,t.StaffingCredentialsAuthProvider=class{constructor(t,e){this.username=t,this.password=e}credential(t){return s(this,void 0,void 0,function*(){return r.get(`${t.login_url}?version=*&username=${this.username}&password=${this.password}&clientId=${t.client_id}`).then(t=>t.data)})}},t.StaffingOAuthProvider=class extends Yt{credential(t){return s(this,void 0,void 0,function*(){this.config=t;const e=yield this.getAuthCode(),r=yield this.validateCode(e);return this.restLogin(r.access_token)})}getAuthCode(){return s(this,void 0,void 0,function*(){try{return(yield r.get(`${this.config.authorization_url}`,{params:{client_id:this.config.client_id,response_type:"code",action:"Login",username:this.config.username,password:this.config.password}})).request.path.split("?code=").pop().split("&").shift()}catch(t){throw console.warn("Error retrieving AuthCode",t.message),t}})}},t.StaffingOAuthPopupProvider=class extends Yt{credential(t){return s(this,void 0,void 0,function*(){this.config=t;const e=`${t.authorization_url}?response_type=code&clientId=${t.client_id}&redirect_uri=${t.redirect_url}`,r=window.open(e,"bhAuthWindow","location=0,status=0,width=800,height=600");return this.getAuthCode(r).then(this.validateCode).then(this.restLogin)})}getAuthCode(t){return s(this,void 0,void 0,function*(){return Promise.resolve().then(()=>{const e=window.setInterval(()=>{try{if(-1!==t.document.URL.indexOf(this.config.redirect_url)){window.clearInterval(e);const r=Ft.destruct(t.document.URL);return t.close(),r.params.access_token}}catch(t){console.warn("Error retrieving AuthCode",t.message)}},1e3)})})}},t.Where=Ht,t.Can=St,t.can=Et,t.Is=Ot,t.is=xt,t.Cache=Dt,t.Deferred=function(){const t={},e=new Promise((e,r)=>{t.resolve=e,t.reject=r});return e.resolve=t.resolve,e.reject=t.reject,e},t.Lazy=class{static from(t){let e,r;const n=new Promise((t,n)=>{e=t,r=n});return n.__then=n.then,n.then=function(n,i){setImmediate(()=>{t(e,r)}),this.__then(n,i)},n}static series(t,e=1){return s(this,void 0,void 0,function*(){let r;const n=t.slice();return new Promise((t,i)=>{const o=s=>{if(r=r?r.concat(s):[],!n.length)return t(r);const a=n.splice(0,e);Promise.all(a).then(o).catch(i)};o()})})}},t.Memory=It,t.QueryString=Ft,t.Browser=jt,t.Entity=be,t.observeOptions=pe,t.getOrCreateObservable=ye,t.EntityList=me,t.observeListOptions=ve,t.EMPTY=Wt,t.StatefulSubject=Jt,Object.defineProperty(t,"__esModule",{value:!0})});
