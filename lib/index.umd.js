!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("axios")):"function"==typeof define&&define.amd?define(["exports","rxjs","axios"],e):e(t.taurus={},t.rxjs,t.axios)}(this,function(t,e,r){"use strict";var n;r=r&&r.hasOwnProperty("default")?r.default:r,(n=t.FieldType||(t.FieldType={}))[n.ID=0]="ID",n[n.COMPOSITE=1]="COMPOSITE",n[n.TO_ONE=2]="TO_ONE",n[n.TO_MANY=3]="TO_MANY",n[n.SCALAR=4]="SCALAR";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function o(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var s=function(){return(s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function u(t,e,r,n){return new(r||(r=Promise))(function(i,o){function s(t){try{a(n.next(t))}catch(t){o(t)}}function u(t){try{a(n.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(s,u)}a((n=n.apply(t,e||[])).next())})}function a(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var c,f={e:{}};function h(){try{return c.apply(this,arguments)}catch(t){return f.e=t,f}}function l(t){return c=t,h}function p(t){return"function"==typeof t}var d=!1,b={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;d=t},get useDeprecatedSynchronousErrorHandling(){return d}};function y(t){setTimeout(function(){throw t})}var v={closed:!0,next:function(t){},error:function(t){if(b.useDeprecatedSynchronousErrorHandling)throw t;y(t)},complete:function(){}},m=Array.isArray||function(t){return t&&"number"==typeof t.length};function g(t){return null!=t&&"object"==typeof t}function _(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}_.prototype=Object.create(Error.prototype);var w=_,S=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var r=this._parent,n=this._parents,i=this._unsubscribe,o=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,u=n?n.length:0;r;)r.remove(this),r=++s<u&&n[s]||null;if(p(i))l(i).call(this)===f&&(e=!0,t=t||(f.e instanceof w?E(f.e.errors):[f.e]));if(m(o))for(s=-1,u=o.length;++s<u;){var a=o[s];if(g(a))if(l(a.unsubscribe).call(a)===f){e=!0,t=t||[];var c=f.e;c instanceof w?t=t.concat(E(c.errors)):t.push(c)}}if(e)throw new w(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var r=e;switch(typeof e){case"function":r=new t(e);case"object":if(r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if("function"!=typeof r._addParent){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(r),r._addParent(this),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.prototype._addParent=function(t){var e=this._parent,r=this._parents;e&&e!==t?r?-1===r.indexOf(t)&&r.push(t):this._parents=[t]:this._parent=t},t.EMPTY=((e=new t).closed=!0,e),t}();function E(t){return t.reduce(function(t,e){return t.concat(e instanceof w?e.errors:e)},[])}var O="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),j=function(t){function e(r,n,i){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,o._parentSubscription=null,arguments.length){case 0:o.destination=v;break;case 1:if(!r){o.destination=v;break}if("object"==typeof r){r instanceof e?(o.syncErrorThrowable=r.syncErrorThrowable,o.destination=r,r.add(o)):(o.syncErrorThrowable=!0,o.destination=new x(o,r));break}default:o.syncErrorThrowable=!0,o.destination=new x(o,r,n,i)}return o}return o(e,t),e.prototype[O]=function(){return this},e.create=function(t,r,n){var i=new e(t,r,n);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this._parentSubscription=null,this},e}(S),x=function(t){function e(e,r,n,i){var o,s=t.call(this)||this;s._parentSubscriber=e;var u=s;return p(r)?o=r:r&&(o=r.next,n=r.error,i=r.complete,r!==v&&(p((u=Object.create(r)).unsubscribe)&&s.add(u.unsubscribe.bind(u)),u.unsubscribe=s.unsubscribe.bind(s))),s._context=u,s._next=o,s._error=n,s._complete=i,s}return o(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;b.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=b.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):y(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;y(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};b.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),b.useDeprecatedSynchronousErrorHandling)throw t;y(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!b.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return b.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(y(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(j),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(j),k=function(t){function e(e,r,n){var i=t.call(this)||this;return i.parent=e,i.outerValue=r,i.outerIndex=n,i.index=0,i}return o(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(j);var A="function"==typeof Symbol&&Symbol.observable||"@@observable";function T(){}var P=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,i=function(t,e,r){if(t){if(t instanceof j)return t;if(t[O])return t[O]()}return t||e||r?new j(t,e,r):new j(v)}(t,e,r);if(n?n.call(i,this.source):i.add(this.source||b.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),b.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){b.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,n=e.destination,i=e.isStopped;if(r||i)return!1;t=n&&n instanceof j?n:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=N(e))(function(e,n){var i;i=r.subscribe(function(e){try{t(e)}catch(t){n(t),i&&i.unsubscribe()}},n,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[A]=function(){return this},t.prototype.pipe=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 0===e.length?this:((t=e)?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:T)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=N(t))(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(e){return new t(e)},t}();function N(t){if(t||(t=b.Promise||Promise),!t)throw new Error("no Promise impl found");return t}var R=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.closed||e.complete()}},C=function(t){return function(e){return t.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,y),e}};var D=function(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}(),L=function(t){return function(e){for(var r=t[D]();;){var n=r.next();if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof r.return&&e.add(function(){r.return&&r.return()}),e}},z=function(t){return function(e){var r=t[A]();if("function"!=typeof r.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return r.subscribe(e)}},F=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function M(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var B=function(t){if(t instanceof P)return function(e){return t._isScalar?(e.next(t.value),void e.complete()):t.subscribe(e)};if(t&&"function"==typeof t[A])return z(t);if(F(t))return R(t);if(M(t))return C(t);if(t&&"function"==typeof t[D])return L(t);var e=g(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function U(t,e,r,n,i){if(void 0===i&&(i=new k(t,r,n)),!i.closed)return B(e)(i)}var V=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new H(t,this.durationSelector))},t}(),H=function(t){function e(e,r){var n=t.call(this,e)||this;return n.durationSelector=r,n.hasValue=!1,n}return o(e,t),e.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=l(this.durationSelector)(t);if(e===f)this.destination.error(f.e);else{var r=U(this,e);!r||r.closed?this.clearThrottle():this.add(this.throttled=r)}}},e.prototype.clearThrottle=function(){var t=this.value,e=this.hasValue,r=this.throttled;r&&(this.remove(r),this.throttled=null,r.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))},e.prototype.notifyNext=function(t,e,r,n){this.clearThrottle()},e.prototype.notifyComplete=function(){this.clearThrottle()},e}(I),$=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n.pending=!1,n}return o(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},e.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),setInterval(t.flush.bind(t,this),r)},e.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var r=!1,n=void 0;try{this.work(t)}catch(t){r=!0,n=!!t&&t||new Error(t)}if(r)return this.unsubscribe(),n},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,r=e.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,r){return t.call(this)||this}return o(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(S)),q=function(){function t(e,r){void 0===r&&(r=t.now),this.SchedulerAction=e,this.now=r}return t.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(r,e)},t.now=function(){return Date.now()},t}(),Q=function(t){function e(r,n){void 0===n&&(n=q.now);var i=t.call(this,r,function(){return e.delegate&&e.delegate!==i?e.delegate.now():n()})||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return o(e,t),e.prototype.schedule=function(r,n,i){return void 0===n&&(n=0),e.delegate&&e.delegate!==this?e.delegate.schedule(r,n,i):t.prototype.schedule.call(this,r,n,i)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var r;this.active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},e}(q),Y=new Q($);function W(t){return!m(t)&&t-parseFloat(t)+1>=0}function J(t){return t&&"function"==typeof t.schedule}function G(t){var e=t.index,r=t.period,n=t.subscriber;if(n.next(e),!n.closed){if(-1===r)return n.complete();t.index=e+1,this.schedule(t,r)}}function K(t,e){return void 0===e&&(e=Y),r=function(){return function(t,e,r){void 0===t&&(t=0);var n=-1;return W(e)?n=Number(e)<1?1:Number(e):J(e)&&(r=e),J(r)||(r=Y),new P(function(e){var i=W(t)?t:+t-r.now();return r.schedule(G,i,{index:0,period:n,subscriber:e})})}(t,e)},function(t){return t.lift(new V(r))};var r}function X(t,e){return new P(e?function(r){var n=new S,i=0;return n.add(e.schedule(function(){i!==t.length?(r.next(t[i++]),r.closed||n.add(this.schedule())):r.complete()})),n}:R(t))}function Z(t,e){if(!e)return t instanceof P?t:new P(B(t));if(null!=t){if(function(t){return t&&"function"==typeof t[A]}(t))return function(t,e){return new P(e?function(r){var n=new S;return n.add(e.schedule(function(){var i=t[A]();n.add(i.subscribe({next:function(t){n.add(e.schedule(function(){return r.next(t)}))},error:function(t){n.add(e.schedule(function(){return r.error(t)}))},complete:function(){n.add(e.schedule(function(){return r.complete()}))}}))})),n}:z(t))}(t,e);if(M(t))return function(t,e){return new P(e?function(r){var n=new S;return n.add(e.schedule(function(){return t.then(function(t){n.add(e.schedule(function(){r.next(t),n.add(e.schedule(function(){return r.complete()}))}))},function(t){n.add(e.schedule(function(){return r.error(t)}))})})),n}:C(t))}(t,e);if(F(t))return X(t,e);if(function(t){return t&&"function"==typeof t[D]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new P(e?function(r){var n,i=new S;return i.add(function(){n&&"function"==typeof n.return&&n.return()}),i.add(e.schedule(function(){n=t[D](),i.add(e.schedule(function(){if(!r.closed){var t,e;try{var i=n.next();t=i.value,e=i.done}catch(t){return void r.error(t)}e?r.complete():(r.next(t),this.schedule())}}))})),i}:L(t))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}var tt=new P(function(t){return t.complete()});function et(t){return t?function(t){return new P(function(e){return t.schedule(function(){return e.complete()})})}(t):tt}var rt=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new nt(t,this.project,this.thisArg))},t}(),nt=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.project=r,i.count=0,i.thisArg=n||i,i}return o(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(j);function it(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof e?function(n){return n.pipe(it(function(r,n){return Z(t(r,n)).pipe(function(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new rt(t,e))}}(function(t,i){return e(r,t,n,i)}))},r))}:("number"==typeof e&&(r=e),function(e){return e.lift(new ot(t,r))})}var ot=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new st(t,this.project,this.concurrent))},t}(),st=function(t){function e(e,r,n){void 0===n&&(n=Number.POSITIVE_INFINITY);var i=t.call(this,e)||this;return i.project=r,i.concurrent=n,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return o(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,r)},e.prototype._innerSub=function(t,e,r){var n=new k(this,void 0,void 0);this.destination.add(n),U(this,t,e,r,n)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(I);function ut(t){return t}function at(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}at.prototype=Object.create(Error.prototype);var ct=at;var ft=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new ht(t,this.predicate,this.thisArg))},t}(),ht=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.predicate=r,i.thisArg=n,i.count=0,i}return o(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(j);function lt(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}lt.prototype=Object.create(Error.prototype);var pt=function(){function t(t){if(this.total=t,this.total<0)throw new ct}return t.prototype.call=function(t,e){return e.subscribe(new dt(t,this.total))},t}(),dt=function(t){function e(e,r){var n=t.call(this,e)||this;return n.total=r,n.count=0,n}return o(e,t),e.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},e}(j);function bt(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}bt.prototype=Object.create(Error.prototype);var yt=bt,vt=function(t){function e(e,r){var n=t.call(this)||this;return n.subject=e,n.subscriber=r,n.closed=!1,n}return o(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(S),mt=function(t){function e(e){var r=t.call(this,e)||this;return r.destination=e,r}return o(e,t),e}(j),gt=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return o(e,t),e.prototype[O]=function(){return new mt(this)},e.prototype.lift=function(t){var e=new _t(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new yt;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new yt;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new yt;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new yt;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new yt;return this.hasError?(t.error(this.thrownError),S.EMPTY):this.isStopped?(t.complete(),S.EMPTY):(this.observers.push(t),new vt(this,t))},e.prototype.asObservable=function(){var t=new P;return t.source=this,t},e.create=function(t,e){return new _t(t,e)},e}(P),_t=function(t){function e(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return o(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):S.EMPTY},e}(gt);function wt(){return function(t){return t.lift(new St(t))}}var St=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var r=this.connectable;r._refCount++;var n=new Et(t,r),i=e.subscribe(n);return n.closed||(n.connection=r.connect()),i},t}(),Et=function(t){function e(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return o(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var r=this.connection,n=t._connection;this.connection=null,!n||r&&n!==r||n.unsubscribe()}}else this.connection=null},e}(j),Ot=function(t){function e(e,r){var n=t.call(this)||this;return n.source=e,n.subjectFactory=r,n._refCount=0,n._isComplete=!1,n}return o(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new S).add(this.source.subscribe(new xt(this.getSubject(),this))),t.closed?(this._connection=null,t=S.EMPTY):this._connection=t),t},e.prototype.refCount=function(){return wt()(this)},e}(P).prototype,jt={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:Ot._subscribe},_isComplete:{value:Ot._isComplete,writable:!0},getSubject:{value:Ot.getSubject},connect:{value:Ot.connect},refCount:{value:Ot.refCount}},xt=function(t){function e(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return o(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(mt);var It=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var r=this.selector,n=this.subjectFactory(),i=r(n).subscribe(t);return i.add(e.subscribe(n)),i},t}();function kt(){return new gt}function At(){return function(t){return wt()((e=kt,function(t){var n;if(n="function"==typeof e?e:function(){return e},"function"==typeof r)return t.lift(new It(n,r));var i=Object.create(t,jt);return i.source=t,i.subjectFactory=n,i})(t));var e,r}}var Tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.complete=function(){},e.prototype.error=function(t){this.error=t,this.observers.forEach(function(e){e.error(t),e.closed=!1})},e}(e.ReplaySubject),Pt=function(){function t(){if(this.subjects=[],this.messageBus=new Tt,this.messageStream=this.messageBus.pipe(At()),t._instance)throw new Error("Error: Instantiation failed: Use EntityMessageBroker.getInstance() instead of new.");t._instance=this}return t.getInstance=function(){return t._instance},t.prototype.emit=function(t,e){void 0===e&&(e={});var r=this.subject(t);return r.next(e),r},t.prototype.subject=function(t){var r=function(t,e){var r=t.filter(function(t){return t.name===e});if(r&&!(r.length<1))return r[0]}(this.subjects,t);return r||((r=new e.Subject).name=t,this.subjects.push(r),this.messageBus.next(r)),r},t.prototype.on=function(t){return-1===t.indexOf("#")&&-1===t.indexOf("*")?this.subject(t):this.messageStream.pipe((r=function(e){return function(t,e){if(-1===e.indexOf("#")&&-1===e.indexOf("*"))return t===e;var r=function(t){return"^"+t.split(".").reduce(function(t,e,r,n){var i="";return n[r-1]&&(i="#"!==n[r-1]?"\\.\\b":"\\b"),t+(i+="#"===e?"[\\s\\S]*":"*"===e?"[^.]+":e)},"")}(e);return new RegExp(r).test(t)}(e.name,t)},function(t){return t.lift(new ft(r,n))}),(void 0===e&&(e=Number.POSITIVE_INFINITY),it(ut,e)));var e,r,n},t._instance=new t,t}(),Nt=function(){function t(t){this.obj=t}return t.prototype.have=function(t){for(var e=t.split("."),r=this.obj,n=0,i=e;n<i.length;n++){if(r=r[i[n]],!1===this.check(r))return r}return r},t.prototype.check=function(t){return void 0!==t},t}();function Rt(t){return new Nt(t)}var Ct=function(){function t(t){this.reference={},this.reference=t}return Object.defineProperty(t.prototype,"aBoolean",{get:function(){return this.a(Boolean)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aDate",{get:function(){return this.a(Date)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aFunction",{get:function(){return this.a(Function)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anArray",{get:function(){return this.a(Array)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anError",{get:function(){return this.a(Error)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anObject",{get:function(){return this.a(Object)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aNonEmptyArray",{get:function(){return this.anArray&&!!this.reference.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aNonEmptyString",{get:function(){return this.aString&&!!this.reference.trim()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aNumber",{get:function(){return this.a(Number)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aRegExp",{get:function(){return this.a(RegExp)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aString",{get:function(){return this.a(String)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defined",{get:function(){return!this.undefined&&!this.null&&!this.nan},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nan",{get:function(){return this.a(NaN)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"null",{get:function(){return this.a(null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"undefined",{get:function(){return this.a(void 0)},enumerable:!0,configurable:!0}),t.prototype.a=function(t){var e=!1,r=this.reference.constructor.name;switch(t){case void 0:e="Undefined"===r;break;case null:e="Null"===r;break;case Array:e="Array"===r;break;case Boolean:e="Boolean"===r;break;case Date:e="Date"===r;break;case Error:e="Error"===r;break;case Function:e="Function"===r;break;case Number:e="Number"===r&&!isNaN(this.reference);break;case RegExp:e="RegExp"===r;break;case String:e="String"===r;break;case Object:e="Object"===r||"Arguments"===r;break;default:e="Number"===t.constructor.name&&isNaN(t)?"Number"===r&&isNaN(this.reference):this.reference instanceof t}return e},t.prototype.aTypeOf=function(t){var e=!1;if("function"==typeof t&&!(e=t===this.reference)&&!(e=t.isPrototypeOf(this.reference)))for(var r=this.reference;"function"==typeof r&&!(e=r===t)&&r!==Object;)r="object"==typeof r.prototype&&Object.getPrototypeOf(r).constructor===Function?(Object.getPrototypeOf(r.prototype)||{}).constructor:Object.getPrototypeOf(r);return e},t}();function Dt(t){return new Ct(t)}var Lt=function(){function t(){this.dataStore={}}return t.prototype.setItem=function(t,e){this.dataStore[t]=e||""},t.prototype.getItem=function(t){return this.dataStore[t]},t.prototype.removeItem=function(t){delete this.dataStore[t]},t.prototype.clear=function(){this.dataStore={}},Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.dataStore).length},enumerable:!0,configurable:!0}),t.prototype.key=function(t){return Object.keys(this.dataStore)[t]||null},t}(),zt=function(){function t(){this.storageSize=5242880;var t=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,e="undefined"!=typeof InstallTrigger,r=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString(),n=!!document.documentMode,i=!n&&!!window.StyleMedia,o=!(!window.chrome||!window.chrome.webstore&&!window.chrome.runtime);(o||t)&&window.CSS;t?this.name="opera":r?this.name="safari":n?this.name="IE":i?this.name="edge":o?this.name="chrome":e&&(this.name="firefox"),(o||e)&&(this.storageSize=10485760)}return t.prototype.getStorageSize=function(){return this.storageSize},t}(),Ft="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Mt(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function Bt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ut(t,e){return t(e={exports:{}},e.exports),e.exports}var Vt=Ut(function(t,e){t.exports=function t(e,r,n){function i(s,u){if(!r[s]){if(!e[s]){var a=Mt;if(!u&&a)return a(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=r[s]={exports:{}};e[s][0].call(f.exports,function(t){var r=e[s][1][t];return i(r||t)},f,f.exports,t,e,r,n)}return r[s].exports}for(var o=Mt,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){(function(t){var r,n,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var o=0,s=new i(f),u=t.document.createTextNode("");s.observe(u,{characterData:!0}),r=function(){u.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){f(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(f,0)};else{var a=new t.MessageChannel;a.port1.onmessage=f,r=function(){a.port2.postMessage(0)}}var c=[];function f(){var t,e;n=!0;for(var r=c.length;r;){for(e=c,c=[],t=-1;++t<r;)e[t]();r=c.length}n=!1}e.exports=function(t){1!==c.push(t)||n||r()}}).call(this,void 0!==Ft?Ft:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,r){var n=t(1);function i(){}var o={},s=["REJECTED"],u=["FULFILLED"],a=["PENDING"];function c(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=a,this.queue=[],this.outcome=void 0,t!==i&&p(this,t)}function f(t,e,r){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function h(t,e,r){n(function(){var n;try{n=e(r)}catch(e){return o.reject(t,e)}n===t?o.reject(t,new TypeError("Cannot resolve promise with itself")):o.resolve(t,n)})}function l(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function p(t,e){var r=!1;function n(e){r||(r=!0,o.reject(t,e))}function i(e){r||(r=!0,o.resolve(t,e))}var s=d(function(){e(i,n)});"error"===s.status&&n(s.value)}function d(t,e){var r={};try{r.value=t(e),r.status="success"}catch(t){r.status="error",r.value=t}return r}e.exports=c,c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){if("function"!=typeof t&&this.state===u||"function"!=typeof e&&this.state===s)return this;var r=new this.constructor(i);if(this.state!==a){var n=this.state===u?t:e;h(r,n,this.outcome)}else this.queue.push(new f(r,t,e));return r},f.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},f.prototype.otherCallFulfilled=function(t){h(this.promise,this.onFulfilled,t)},f.prototype.callRejected=function(t){o.reject(this.promise,t)},f.prototype.otherCallRejected=function(t){h(this.promise,this.onRejected,t)},o.resolve=function(t,e){var r=d(l,e);if("error"===r.status)return o.reject(t,r.value);var n=r.value;if(n)p(t,n);else{t.state=u,t.outcome=e;for(var i=-1,s=t.queue.length;++i<s;)t.queue[i].callFulfilled(e)}return t},o.reject=function(t,e){t.state=s,t.outcome=e;for(var r=-1,n=t.queue.length;++r<n;)t.queue[r].callRejected(e);return t},c.resolve=function(t){return t instanceof this?t:o.resolve(new this(i),t)},c.reject=function(t){var e=new this(i);return o.reject(e,t)},c.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,n=!1;if(!r)return this.resolve([]);for(var s=new Array(r),u=0,a=-1,c=new this(i);++a<r;)f(t[a],a);return c;function f(t,i){e.resolve(t).then(function(t){s[i]=t,++u!==r||n||(n=!0,o.resolve(c,s))},function(t){n||(n=!0,o.reject(c,t))})}},c.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,n=!1;if(!r)return this.resolve([]);for(var s,u=-1,a=new this(i);++u<r;)s=t[u],e.resolve(s).then(function(t){n||(n=!0,o.resolve(a,t))},function(t){n||(n=!0,o.reject(a,t))});return a}},{1:1}],3:[function(t,e,r){(function(e){"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==Ft?Ft:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();function o(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(o){if("TypeError"!==o.name)throw o;for(var r="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,n=new r,i=0;i<t.length;i+=1)n.append(t[i]);return n.getBlob(e.type)}}"undefined"==typeof Promise&&t(3);var s=Promise;function u(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function a(t,e,r){"function"==typeof e&&t.then(e),"function"==typeof r&&t.catch(r)}function c(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function f(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var h="local-forage-detect-blob-support",l=void 0,p={},d=Object.prototype.toString,b="readonly",y="readwrite";function v(t){return"boolean"==typeof l?s.resolve(l):function(t){return new s(function(e){var r=t.transaction(h,y),n=o([""]);r.objectStore(h).put(n,"key"),r.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},r.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);e(r||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1})}(t).then(function(t){return l=t})}function m(t){var e=p[t.name],r={};r.promise=new s(function(t,e){r.resolve=t,r.reject=e}),e.deferredOperations.push(r),e.dbReady?e.dbReady=e.dbReady.then(function(){return r.promise}):e.dbReady=r.promise}function g(t){var e=p[t.name],r=e.deferredOperations.pop();if(r)return r.resolve(),r.promise}function _(t,e){var r=p[t.name],n=r.deferredOperations.pop();if(n)return n.reject(e),n.promise}function w(t,e){return new s(function(r,n){if(p[t.name]=p[t.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},t.db){if(!e)return r(t.db);m(t),t.db.close()}var o=[t.name];e&&o.push(t.version);var s=i.open.apply(i,o);e&&(s.onupgradeneeded=function(e){var r=s.result;try{r.createObjectStore(t.storeName),e.oldVersion<=1&&r.createObjectStore(h)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),s.onerror=function(t){t.preventDefault(),n(s.error)},s.onsuccess=function(){r(s.result),g(t)}})}function S(t){return w(t,!1)}function E(t){return w(t,!0)}function O(t,e){if(!t.db)return!0;var r=!t.db.objectStoreNames.contains(t.storeName),n=t.version<t.db.version,i=t.version>t.db.version;if(n&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),i||r){if(r){var o=t.db.version+1;o>t.version&&(t.version=o)}return!0}return!1}function j(t){var e=function(t){for(var e=t.length,r=new ArrayBuffer(e),n=new Uint8Array(r),i=0;i<e;i++)n[i]=t.charCodeAt(i);return r}(atob(t.data));return o([e],{type:t.type})}function x(t){return t&&t.__local_forage_encoded_blob}function I(t){var e=this,r=e._initReady().then(function(){var t=p[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return a(r,t,t),r}function k(t,e,r,n){void 0===n&&(n=1);try{var i=t.db.transaction(t.storeName,e);r(null,i)}catch(i){if(n>0&&(!t.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return s.resolve().then(function(){if(!t.db||"NotFoundError"===i.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),E(t)}).then(function(){return function(t){m(t);for(var e=p[t.name],r=e.forages,n=0;n<r.length;n++){var i=r[n];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return t.db=null,S(t).then(function(e){return t.db=e,O(t)?E(t):e}).then(function(n){t.db=e.db=n;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=n}).catch(function(e){throw _(t,e),e})}(t).then(function(){k(t,e,r,n-1)})}).catch(r);r(i)}}var A={_driver:"asyncStorage",_initStorage:function(t){var e=this,r={db:null};if(t)for(var n in t)r[n]=t[n];var i=p[r.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},p[r.name]=i),i.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=I);var o=[];function u(){return s.resolve()}for(var a=0;a<i.forages.length;a++){var c=i.forages[a];c!==e&&o.push(c._initReady().catch(u))}var f=i.forages.slice(0);return s.all(o).then(function(){return r.db=i.db,S(r)}).then(function(t){return r.db=t,O(r,e._defaultConfig.version)?E(r):t}).then(function(t){r.db=i.db=t,e._dbInfo=r;for(var n=0;n<f.length;n++){var o=f[n];o!==e&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}})},_support:function(){try{if(!i)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(t,e){var r=this,n=new s(function(e,n){r.ready().then(function(){k(r._dbInfo,b,function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName),u=s.openCursor(),a=1;u.onsuccess=function(){var r=u.result;if(r){var n=r.value;x(n)&&(n=j(n));var i=t(n,r.key,a++);void 0!==i?e(i):r.continue()}else e()},u.onerror=function(){n(u.error)}}catch(t){n(t)}})}).catch(n)});return u(n,e),n},getItem:function(t,e){var r=this;t=c(t);var n=new s(function(e,n){r.ready().then(function(){k(r._dbInfo,b,function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName),u=s.get(t);u.onsuccess=function(){var t=u.result;void 0===t&&(t=null),x(t)&&(t=j(t)),e(t)},u.onerror=function(){n(u.error)}}catch(t){n(t)}})}).catch(n)});return u(n,e),n},setItem:function(t,e,r){var n=this;t=c(t);var i=new s(function(r,i){var o;n.ready().then(function(){return o=n._dbInfo,"[object Blob]"===d.call(e)?v(o.db).then(function(t){return t?e:(r=e,new s(function(t,e){var n=new FileReader;n.onerror=e,n.onloadend=function(e){var n=btoa(e.target.result||"");t({__local_forage_encoded_blob:!0,data:n,type:r.type})},n.readAsBinaryString(r)}));var r}):e}).then(function(e){k(n._dbInfo,y,function(o,s){if(o)return i(o);try{var u=s.objectStore(n._dbInfo.storeName);null===e&&(e=void 0);var a=u.put(e,t);s.oncomplete=function(){void 0===e&&(e=null),r(e)},s.onabort=s.onerror=function(){var t=a.error?a.error:a.transaction.error;i(t)}}catch(t){i(t)}})}).catch(i)});return u(i,r),i},removeItem:function(t,e){var r=this;t=c(t);var n=new s(function(e,n){r.ready().then(function(){k(r._dbInfo,y,function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName),u=s.delete(t);o.oncomplete=function(){e()},o.onerror=function(){n(u.error)},o.onabort=function(){var t=u.error?u.error:u.transaction.error;n(t)}}catch(t){n(t)}})}).catch(n)});return u(n,e),n},clear:function(t){var e=this,r=new s(function(t,r){e.ready().then(function(){k(e._dbInfo,y,function(n,i){if(n)return r(n);try{var o=i.objectStore(e._dbInfo.storeName),s=o.clear();i.oncomplete=function(){t()},i.onabort=i.onerror=function(){var t=s.error?s.error:s.transaction.error;r(t)}}catch(t){r(t)}})}).catch(r)});return u(r,t),r},length:function(t){var e=this,r=new s(function(t,r){e.ready().then(function(){k(e._dbInfo,b,function(n,i){if(n)return r(n);try{var o=i.objectStore(e._dbInfo.storeName),s=o.count();s.onsuccess=function(){t(s.result)},s.onerror=function(){r(s.error)}}catch(t){r(t)}})}).catch(r)});return u(r,t),r},key:function(t,e){var r=this,n=new s(function(e,n){t<0?e(null):r.ready().then(function(){k(r._dbInfo,b,function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName),u=!1,a=s.openCursor();a.onsuccess=function(){var r=a.result;r?0===t?e(r.key):u?e(r.key):(u=!0,r.advance(t)):e(null)},a.onerror=function(){n(a.error)}}catch(t){n(t)}})}).catch(n)});return u(n,e),n},keys:function(t){var e=this,r=new s(function(t,r){e.ready().then(function(){k(e._dbInfo,b,function(n,i){if(n)return r(n);try{var o=i.objectStore(e._dbInfo.storeName),s=o.openCursor(),u=[];s.onsuccess=function(){var e=s.result;e?(u.push(e.key),e.continue()):t(u)},s.onerror=function(){r(s.error)}}catch(t){r(t)}})}).catch(r)});return u(r,t),r},dropInstance:function(t,e){e=f.apply(this,arguments);var r,n=this.config();if((t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName),t.name){var o=t.name===n.name&&this._dbInfo.db,a=o?s.resolve(this._dbInfo.db):S(t).then(function(e){var r=p[t.name],n=r.forages;r.db=e;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=e;return e});r=t.storeName?a.then(function(e){if(e.objectStoreNames.contains(t.storeName)){var r=e.version+1;m(t);var n=p[t.name],o=n.forages;e.close();for(var u=0;u<o.length;u++){var a=o[u];a._dbInfo.db=null,a._dbInfo.version=r}var c=new s(function(e,n){var o=i.open(t.name,r);o.onerror=function(t){var e=o.result;e.close(),n(t)},o.onupgradeneeded=function(){var e=o.result;e.deleteObjectStore(t.storeName)},o.onsuccess=function(){var t=o.result;t.close(),e(t)}});return c.then(function(t){n.db=t;for(var e=0;e<o.length;e++){var r=o[e];r._dbInfo.db=t,g(r._dbInfo)}}).catch(function(e){throw(_(t,e)||s.resolve()).catch(function(){}),e})}}):a.then(function(e){m(t);var r=p[t.name],n=r.forages;e.close();for(var o=0;o<n.length;o++){var u=n[o];u._dbInfo.db=null}var a=new s(function(e,r){var n=i.deleteDatabase(t.name);n.onerror=n.onblocked=function(t){var e=n.result;e&&e.close(),r(t)},n.onsuccess=function(){var t=n.result;t&&t.close(),e(t)}});return a.then(function(t){r.db=t;for(var e=0;e<n.length;e++){var i=n[e];g(i._dbInfo)}}).catch(function(e){throw(_(t,e)||s.resolve()).catch(function(){}),e})})}else r=s.reject("Invalid arguments");return u(r,e),r}},T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P="~~local_forage_type~",N=/^~~local_forage_type~([^~]+)~/,R="__lfsc__:",C=R.length,D="arbf",L="blob",z="si08",F="ui08",M="uic8",B="si16",U="si32",V="ur16",H="ui32",$="fl32",q="fl64",Q=C+D.length,Y=Object.prototype.toString;function W(t){var e,r,n,i,o,s=.75*t.length,u=t.length,a=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var c=new ArrayBuffer(s),f=new Uint8Array(c);for(e=0;e<u;e+=4)r=T.indexOf(t[e]),n=T.indexOf(t[e+1]),i=T.indexOf(t[e+2]),o=T.indexOf(t[e+3]),f[a++]=r<<2|n>>4,f[a++]=(15&n)<<4|i>>2,f[a++]=(3&i)<<6|63&o;return c}function J(t){var e,r=new Uint8Array(t),n="";for(e=0;e<r.length;e+=3)n+=T[r[e]>>2],n+=T[(3&r[e])<<4|r[e+1]>>4],n+=T[(15&r[e+1])<<2|r[e+2]>>6],n+=T[63&r[e+2]];return r.length%3==2?n=n.substring(0,n.length-1)+"=":r.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var G={serialize:function(t,e){var r="";if(t&&(r=Y.call(t)),t&&("[object ArrayBuffer]"===r||t.buffer&&"[object ArrayBuffer]"===Y.call(t.buffer))){var n,i=R;t instanceof ArrayBuffer?(n=t,i+=D):(n=t.buffer,"[object Int8Array]"===r?i+=z:"[object Uint8Array]"===r?i+=F:"[object Uint8ClampedArray]"===r?i+=M:"[object Int16Array]"===r?i+=B:"[object Uint16Array]"===r?i+=V:"[object Int32Array]"===r?i+=U:"[object Uint32Array]"===r?i+=H:"[object Float32Array]"===r?i+=$:"[object Float64Array]"===r?i+=q:e(new Error("Failed to get type for BinaryArray"))),e(i+J(n))}else if("[object Blob]"===r){var o=new FileReader;o.onload=function(){var r=P+t.type+"~"+J(this.result);e(R+L+r)},o.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(r){console.error("Couldn't convert value into a JSON string: ",t),e(null,r)}},deserialize:function(t){if(t.substring(0,C)!==R)return JSON.parse(t);var e,r=t.substring(Q),n=t.substring(C,Q);if(n===L&&N.test(r)){var i=r.match(N);e=i[1],r=r.substring(i[0].length)}var s=W(r);switch(n){case D:return s;case L:return o([s],{type:e});case z:return new Int8Array(s);case F:return new Uint8Array(s);case M:return new Uint8ClampedArray(s);case B:return new Int16Array(s);case V:return new Uint16Array(s);case U:return new Int32Array(s);case H:return new Uint32Array(s);case $:return new Float32Array(s);case q:return new Float64Array(s);default:throw new Error("Unkown type: "+n)}},stringToBuffer:W,bufferToString:J};function K(t,e,r,n){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function X(t,e,r,n,i,o){t.executeSql(r,n,i,function(t,s){s.code===s.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],function(t,u){u.rows.length?o(t,s):K(t,e,function(){t.executeSql(r,n,i,o)},o)},o):o(t,s)},o)}var Z={_driver:"webSQLStorage",_initStorage:function(t){var e=this,r={db:null};if(t)for(var n in t)r[n]="string"!=typeof t[n]?t[n].toString():t[n];var i=new s(function(t,n){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(t){return n(t)}r.db.transaction(function(i){K(i,r,function(){e._dbInfo=r,t()},function(t,e){n(e)})},n)});return r.serializer=G,i},_support:"function"==typeof openDatabase,iterate:function(t,e){var r=this,n=new s(function(e,n){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){X(r,i,"SELECT * FROM "+i.storeName,[],function(r,n){for(var o=n.rows,s=o.length,u=0;u<s;u++){var a=o.item(u),c=a.value;if(c&&(c=i.serializer.deserialize(c)),void 0!==(c=t(c,a.key,u+1)))return void e(c)}e()},function(t,e){n(e)})})}).catch(n)});return u(n,e),n},getItem:function(t,e){var r=this;t=c(t);var n=new s(function(e,n){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){X(r,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[t],function(t,r){var n=r.rows.length?r.rows.item(0).value:null;n&&(n=i.serializer.deserialize(n)),e(n)},function(t,e){n(e)})})}).catch(n)});return u(n,e),n},setItem:function(t,e,r){return function t(e,r,n,i){var o=this;e=c(e);var a=new s(function(s,u){o.ready().then(function(){void 0===r&&(r=null);var a=r,c=o._dbInfo;c.serializer.serialize(r,function(r,f){f?u(f):c.db.transaction(function(t){X(t,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,r],function(){s(a)},function(t,e){u(e)})},function(r){if(r.code===r.QUOTA_ERR){if(i>0)return void s(t.apply(o,[e,a,n,i-1]));u(r)}})})}).catch(u)});return u(a,n),a}.apply(this,[t,e,r,1])},removeItem:function(t,e){var r=this;t=c(t);var n=new s(function(e,n){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){X(r,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){n(e)})})}).catch(n)});return u(n,e),n},clear:function(t){var e=this,r=new s(function(t,r){e.ready().then(function(){var n=e._dbInfo;n.db.transaction(function(e){X(e,n,"DELETE FROM "+n.storeName,[],function(){t()},function(t,e){r(e)})})}).catch(r)});return u(r,t),r},length:function(t){var e=this,r=new s(function(t,r){e.ready().then(function(){var n=e._dbInfo;n.db.transaction(function(e){X(e,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],function(e,r){var n=r.rows.item(0).c;t(n)},function(t,e){r(e)})})}).catch(r)});return u(r,t),r},key:function(t,e){var r=this,n=new s(function(e,n){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){X(r,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,r){var n=r.rows.length?r.rows.item(0).key:null;e(n)},function(t,e){n(e)})})}).catch(n)});return u(n,e),n},keys:function(t){var e=this,r=new s(function(t,r){e.ready().then(function(){var n=e._dbInfo;n.db.transaction(function(e){X(e,n,"SELECT key FROM "+n.storeName,[],function(e,r){for(var n=[],i=0;i<r.rows.length;i++)n.push(r.rows.item(i).key);t(n)},function(t,e){r(e)})})}).catch(r)});return u(r,t),r},dropInstance:function(t,e){e=f.apply(this,arguments);var r=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||r.name,t.storeName=t.storeName||r.storeName);var n,i=this;return u(n=t.name?new s(function(e){var n;n=t.name===r.name?i._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?e({db:n,storeNames:[t.storeName]}):e(function(t){return new s(function(e,r){t.transaction(function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(r,n){for(var i=[],o=0;o<n.rows.length;o++)i.push(n.rows.item(o).name);e({db:t,storeNames:i})},function(t,e){r(e)})},function(t){r(t)})})}(n))}).then(function(t){return new s(function(e,r){t.db.transaction(function(n){function i(t){return new s(function(e,r){n.executeSql("DROP TABLE IF EXISTS "+t,[],function(){e()},function(t,e){r(e)})})}for(var o=[],u=0,a=t.storeNames.length;u<a;u++)o.push(i(t.storeNames[u]));s.all(o).then(function(){e()}).catch(function(t){r(t)})},function(t){r(t)})})}):s.reject("Invalid arguments"),e),n}};function tt(t,e){var r=t.name+"/";return t.storeName!==e.storeName&&(r+=t.storeName+"/"),r}function et(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(t){return!0}}()||localStorage.length>0}var rt={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var r in t)e[r]=t[r];return e.keyPrefix=tt(t,this._defaultConfig),et()?(this._dbInfo=e,e.serializer=G,s.resolve()):s.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(t,e){var r=this,n=r.ready().then(function(){for(var e=r._dbInfo,n=e.keyPrefix,i=n.length,o=localStorage.length,s=1,u=0;u<o;u++){var a=localStorage.key(u);if(0===a.indexOf(n)){var c=localStorage.getItem(a);if(c&&(c=e.serializer.deserialize(c)),void 0!==(c=t(c,a.substring(i),s++)))return c}}});return u(n,e),n},getItem:function(t,e){var r=this;t=c(t);var n=r.ready().then(function(){var e=r._dbInfo,n=localStorage.getItem(e.keyPrefix+t);return n&&(n=e.serializer.deserialize(n)),n});return u(n,e),n},setItem:function(t,e,r){var n=this;t=c(t);var i=n.ready().then(function(){void 0===e&&(e=null);var r=e;return new s(function(i,o){var s=n._dbInfo;s.serializer.serialize(e,function(e,n){if(n)o(n);else try{localStorage.setItem(s.keyPrefix+t,e),i(r)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||o(t),o(t)}})})});return u(i,r),i},removeItem:function(t,e){var r=this;t=c(t);var n=r.ready().then(function(){var e=r._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return u(n,e),n},clear:function(t){var e=this,r=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var n=localStorage.key(r);0===n.indexOf(t)&&localStorage.removeItem(n)}});return u(r,t),r},length:function(t){var e=this.keys().then(function(t){return t.length});return u(e,t),e},key:function(t,e){var r=this,n=r.ready().then(function(){var e,n=r._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(n.keyPrefix.length)),e});return u(n,e),n},keys:function(t){var e=this,r=e.ready().then(function(){for(var t=e._dbInfo,r=localStorage.length,n=[],i=0;i<r;i++){var o=localStorage.key(i);0===o.indexOf(t.keyPrefix)&&n.push(o.substring(t.keyPrefix.length))}return n});return u(r,t),r},dropInstance:function(t,e){if(e=f.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var r=this.config();t.name=t.name||r.name,t.storeName=t.storeName||r.storeName}var n,i=this;return u(n=t.name?new s(function(e){t.storeName?e(tt(t,i._defaultConfig)):e(t.name+"/")}).then(function(t){for(var e=localStorage.length-1;e>=0;e--){var r=localStorage.key(e);0===r.indexOf(t)&&localStorage.removeItem(r)}}):s.reject("Invalid arguments"),e),n}},nt=function(t,e){for(var r=t.length,n=0;n<r;){if((i=t[n])===(o=e)||"number"==typeof i&&"number"==typeof o&&isNaN(i)&&isNaN(o))return!0;n++}var i,o;return!1},it=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},ot={},st={},ut={INDEXEDDB:A,WEBSQL:Z,LOCALSTORAGE:rt},at=[ut.INDEXEDDB._driver,ut.WEBSQL._driver,ut.LOCALSTORAGE._driver],ct=["dropInstance"],ft=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ct),ht={description:"",driver:at.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function lt(t,e){t[e]=function(){var r=arguments;return t.ready().then(function(){return t[e].apply(t,r)})}}function pt(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var r in e)e.hasOwnProperty(r)&&(it(e[r])?arguments[0][r]=e[r].slice():arguments[0][r]=e[r])}return arguments[0]}var dt=function(){function t(e){for(var r in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ut)if(ut.hasOwnProperty(r)){var n=ut[r],i=n._driver;this[r]=i,ot[i]||this.defineDriver(n)}this._defaultConfig=pt({},ht),this._config=pt({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":n(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t&&t.driver)||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,r){var n=new s(function(e,r){try{var n=t._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void r(i);for(var o=ft.concat("_initStorage"),a=0,c=o.length;a<c;a++){var f=o[a],h=!nt(ct,f);if((h||t[f])&&"function"!=typeof t[f])return void r(i)}!function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),r=s.reject(e);return u(r,arguments[arguments.length-1]),r}},r=0,n=ct.length;r<n;r++){var i=ct[r];t[i]||(t[i]=e(i))}}();var l=function(r){ot[n]&&console.info("Redefining LocalForage driver: "+n),ot[n]=t,st[n]=r,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(l,r):l(!!t._support):l(!0)}catch(t){r(t)}});return a(n,e,r),n},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,r){var n=ot[t]?s.resolve(ot[t]):s.reject(new Error("Driver not found."));return a(n,e,r),n},t.prototype.getSerializer=function(t){var e=s.resolve(G);return a(e,t),e},t.prototype.ready=function(t){var e=this,r=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return a(r,t,t),r},t.prototype.setDriver=function(t,e,r){var n=this;it(t)||(t=[t]);var i=this._getSupportedDrivers(t);function o(){n._config.driver=n.driver()}function u(t){return n._extend(t),o(),n._ready=n._initStorage(n._config),n._ready}var c=null!==this._driverSet?this._driverSet.catch(function(){return s.resolve()}):s.resolve();return this._driverSet=c.then(function(){var t=i[0];return n._dbInfo=null,n._ready=null,n.getDriver(t).then(function(t){n._driver=t._driver,o(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(t){return function(){var e=0;return function r(){for(;e<t.length;){var i=t[e];return e++,n._dbInfo=null,n._ready=null,n.getDriver(i).then(u).catch(r)}o();var a=new Error("No available storage method found.");return n._driverSet=s.reject(a),n._driverSet}()}}(i)})}).catch(function(){o();var t=new Error("No available storage method found.");return n._driverSet=s.reject(t),n._driverSet}),a(this._driverSet,e,r),this._driverSet},t.prototype.supports=function(t){return!!st[t]},t.prototype._extend=function(t){pt(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];this.supports(i)&&e.push(i)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=ft.length;t<e;t++)lt(this,ft[t])},t.prototype.createInstance=function(e){return new t(e)},t}(),bt=new dt;e.exports=bt},{3:3}]},{},[4])(4)}),Ht=new Lt,$t=new zt;try{Vt.originalSupports=Vt.supports,Vt.supports=function(t){try{var e=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);if(e){var r=parseInt(navigator.userAgent.split("Version/")[1].split(" ")[0],10);return r>10.2}}catch(t){console.error("Error in overrideLocalForageSupport",t)}return Vt.originalSupports(t)},Vt.config({driver:[Vt.INDEXEDDB,Vt.LOCALSTORAGE],name:"keyval-store",storeName:"keyval"}),window.localStorage&&(Ht=window.localStorage)}catch(t){console.warn("Unable to setup localforage cache.",t.message)}var qt=function(){function t(){}return Object.defineProperty(t,"storage",{set:function(t){Ht=t},enumerable:!0,configurable:!0}),t.list=function(){return u(this,void 0,void 0,function(){var t,e;return a(this,function(r){switch(r.label){case 0:return void 0===Vt?[3,3]:[4,Vt.ready()];case 1:return r.sent(),[4,Vt.iterate(function(t,e){console.debug(e+" --\x3e "+t)})];case 2:return r.sent(),[2];case 3:for(t=0;t<Ht.length;t++)e=Ht.key(t),console&&e&&console.debug(Ht.key(t)+" --\x3e "+Ht.getItem(e));return[2]}})})},t.exceedsStorageLimit=function(e,r){var n=$t.getStorageSize();return t.getLocalStorageSize()+2*((e?e.length:0)+(r?r.length:0))>=n},t.getLocalStorageSize=function(){for(var t=0,e=0,r=Object.keys(Ht);e<r.length;e++){var n=r[e];if(Ht.hasOwnProperty(n))t+=2*(localStorage[n].length+n.length)}return t},t.put=function(e,r){return u(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return void 0===Vt?[3,3]:[4,Vt.ready()];case 1:return n.sent(),[4,Vt.setItem(e,r)];case 2:return n.sent(),[2,Promise.resolve(r)];case 3:if(!t.exceedsStorageLimit(e,r)){null!==r&&"object"==typeof r&&(r.dateCached=(new Date).getTime());try{Ht.setItem(e,JSON.stringify(r))}catch(t){console.error(t)}}return[2,Promise.resolve(r)]}})})},t.get=function(e,r){return void 0===r&&(r=!0),u(this,void 0,void 0,function(){var n,i=this;return a(this,function(o){switch(o.label){case 0:return void 0===Vt?[3,2]:[4,Vt.ready()];case 1:return o.sent(),r&&setTimeout(function(){return u(i,void 0,void 0,function(){return a(this,function(r){return[2,t.handleStorageRankingUpdate(e)]})})},0),[2,Vt.getItem(e)];case 2:return(n=Ht.getItem(e))?(r&&setTimeout(function(){return u(i,void 0,void 0,function(){return a(this,function(r){return[2,t.handleStorageRankingUpdate(e)]})})},0),[2,Promise.resolve(JSON.parse(n))]):[2,null]}})})},t.has=function(e){return u(this,void 0,void 0,function(){var r,n,i;return a(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t.get(e)];case 1:return r=o.sent(),n=Date.now()-864e5,void 0!==r&&r&&""!==r?r.dateCached?[2,r.dateCached>n]:[2,Promise.resolve(!0)]:[2,Promise.resolve(!1)];case 2:return i=o.sent(),console.warn("An error occurred while looking for "+e+" in Cache",i),[2,Promise.resolve(!1)];case 3:return[2]}})})},t.remove=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return void 0===Vt?[3,3]:[4,Vt.ready()];case 1:return e.sent(),[4,Vt.removeItem(t)];case 2:return e.sent(),[2];case 3:return Ht.removeItem(t),[2]}})})},t.clear=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return void 0===Vt?[3,3]:[4,Vt.ready()];case 1:return t.sent(),[4,Vt.clear()];case 2:return t.sent(),[2];case 3:return Ht.clear(),[2]}})})},t.getStorageRankings=function(){return u(this,void 0,void 0,function(){var e;return a(this,function(r){switch(r.label){case 0:return[4,t.get("storageRankings",!1)];case 1:return(e=r.sent())&&"string"==typeof e?[2,JSON.parse(e)]:e&&"object"==typeof e?[2,e]:[2,{}]}})})},t.handleStorageRankingUpdate=function(e){return u(this,void 0,void 0,function(){var r;return a(this,function(n){switch(n.label){case 0:return[4,t.getStorageRankings()];case 1:return(r=n.sent())[e]=r[e]?parseInt(r[e],10)+1:1,t.put("storageRankings",r),[2]}})})},t}();var Qt=function(){function t(){}return t.from=function(t){var e,r,n=new Promise(function(t,n){e=t,r=n});return n.__then=n.then,n.then=function(n,i){setImmediate(function(){t(e,r)}),this.__then(n,i)},n},t.series=function(t,e){return void 0===e&&(e=1),u(this,void 0,void 0,function(){var r,n;return a(this,function(i){return n=t.slice(),[2,new Promise(function(t,i){var o=function(s){if(r=r?r.concat(s):[],!n.length)return t(r);var u=n.splice(0,e);Promise.all(u).then(o).catch(i)};o()})]})})},t}(),Yt=function(){function t(e,r){void 0===r&&(r={}),this.parts=[],this.url=e,this.parts=t.encodeParams(r)}return t.destruct=function(t){var e=t.protocol+"//"+t.host+t.pathname,r={};return t.search.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(t,e,n,i){r[decodeURIComponent(e)]=decodeURIComponent(i)}),{url:e,params:r}},t.encodeParams=function(t){var e=[];if(t)for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r],o=t[i];Array.isArray(o)?e.push(i+"="+encodeURIComponent(o.join(","))):e.push(i+"="+encodeURIComponent(o))}return e},t.stringify=function(e){return t.encodeParams(e).join("&")},t.prototype.toString=function(){return this.url+(-1===this.url.indexOf("?")?"?":"&")+this.parts.join("&")},t}(),Wt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.useCookies=!1,this.config={client_id:"UNDEFINED",client_secret:"UNDEFINED",authorization_url:"https://auth.bullhornstaffing.com/oauth/authorize",token_url:"https://auth.bullhornstaffing.com/oauth/token",login_url:"https://rest.bullhornstaffing.com/rest-services/login",redirect_url:"https://localhost:3000",apiVersion:"*",useCookies:!1},this.config=s({},this.config,this.options),this.useCookies=t.useCookies||!1,this.options.BhRestToken?qt.put("BhRestToken",this.config.BhRestToken):this.useCookies=!0,this.options.restUrl&&qt.put("restUrl",this.config.restUrl)}return t.prototype.login=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){return[2,t.credential(this.config).then(function(t){return qt.put("BhRestToken",t.BhRestToken),qt.put("restUrl",t.restUrl),t})]})})},t.prototype.isLoggedIn=function(){return u(this,void 0,void 0,function(){return a(this,function(t){return[2,this.ping()]})})},t.http=function(){return u(this,void 0,void 0,function(){var e,r,n,i,o;return a(this,function(s){switch(s.label){case 0:return(e=function(t){if("undefined"!=typeof document)for(var e=t+"=",r=0,n=document.cookie.split(";");r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(e))return i.substring(e.length,i.length)}return!1}("UlEncodedIdentity"))&&e.length?(r=JSON.parse(decodeURIComponent(e)),n=r.sessions.reduce(function(t,e){return t[e.name]=e.value.endpoint,t},{}),t._http.defaults.baseURL=n.rest,t._http.defaults.withCredentials=!0,[2,t.makeCall()]):[4,qt.get("BhRestToken")];case 1:return i=s.sent(),[4,qt.get("restUrl")];case 2:return o=s.sent(),i&&o&&(t._http.defaults.baseURL=o,t._http.defaults.params={BhRestToken:i},t._http.defaults.withCredentials=!1),[2,t.makeCall()]}})})},t.makeCall=function(){var e=this;return t.httpInitialized||(t.httpInitialized=!0,t._http.interceptors.response.use(function(e){var r=e.config._timing||void 0;return t.trackingCallback&&r&&t.trackingCallback(r.url,(new Date).getTime()-r.start),e},function(r){return u(e,void 0,void 0,function(){var e,n;return a(this,function(i){return e=r.response,n=e.config._timing||{},t.trackingCallback&&n&&t.trackingCallback(n.url,(new Date).getTime()-n.start),401===r.response.status&&t.unauthorized.next(r),[2,Promise.reject(r)]})})}),t._http.interceptors.request.use(function(t){return t._timing={start:(new Date).getTime(),url:(t.url||"").replace(t.baseURL||"","").split("?")[0]},t})),t._http},t.prototype.ping=function(){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,t.http()];case 1:return[2,e.sent().get("ping")]}})})},t.unauthorized=new e.Subject,t._http=r.create({paramsSerializer:function(t){return Yt.stringify(t)}}),t.httpInitialized=!1,t}(),Jt=function(){function t(t){this.entity=t,this.memory={},this.fields=[],this.layouts=[],this.tracks=[],this.sectionHeaders=[],this.allFieldsLoaded=!1,this.parameters={fields:"*",meta:"full"},this.initialized=this.initialize()}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t,e;return a(this,function(r){switch(r.label){case 0:return t=this,[4,Wt.http()];case 1:return t.http=r.sent(),[4,qt.get(this.endpoint)];case 2:return(e=r.sent())?this.parse(e):this.parse({fields:[],layouts:[]}),[2]}})})},Object.defineProperty(t.prototype,"endpoint",{get:function(){return"meta/"+this.entity},enumerable:!0,configurable:!0}),t.prototype.setFieldsOnLayout=function(t,e){if(t&&t.layouts){var r=t.layouts.findIndex(function(t){return t.name===e});return r>-1&&(t.layouts[r].fields=t.fields.map(function(t){return t.name})),r}return-1},t.prototype.style=function(t){return void 0===t&&(t="full"),this.parameters.meta=t,this},t.prototype.params=function(t){return this.parameters=s({},this.parameters,t),this},t.prototype.get=function(t,e){return u(this,void 0,void 0,function(){var r,n,i;return a(this,function(o){switch(o.label){case 0:return[4,this.initialized];case 1:return o.sent(),(r=this.missing(t)).length||e?(this.parameters.fields=r.join(","),e&&(this.parameters.layout=e),[4,this.http.get(this.endpoint,{params:this.parameters})]):[3,3];case 2:return n=o.sent(),i=n.data,this.allFieldsLoaded="*"===t[0],this.parse(i),this.label=i.label,[2,this.extract(t)];case 3:return[2,this.extract(t)]}})})},t.prototype.getTracks=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),this.memory?[3,3]:[4,this.get(["*"])];case 2:return t.sent(),[2,this.tracks];case 3:return[2,this.tracks]}})})},t.prototype.getFields=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),this.memory?[3,3]:[4,this.get(["*"])];case 2:return t.sent(),[2,this.fields];case 3:return[2,this.fields]}})})},t.prototype.getAllLayouts=function(){return u(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),this.allFieldsLoaded?[2,this.layouts]:[4,this.http.get(this.endpoint,{params:{meta:"full",includeLayoutFields:!0}})];case 2:return t=e.sent(),this.parse(t.data),[2,t.data.layouts]}})})},t.prototype.getFull=function(t,e){return u(this,void 0,void 0,function(){var r,n,i,o;return a(this,function(s){switch(s.label){case 0:return[4,this.initialized];case 1:return s.sent(),[4,this.get(t)];case 2:return r=s.sent(),e?[4,this.getByLayout(e)]:[3,4];case 3:return i=s.sent(),[3,5];case 4:i=[],s.label=5;case 5:return n=i,[4,qt.get(this.endpoint)];case 6:return(o=s.sent()).fields=r.concat(n),[2,o]}})})},t.prototype.getByLayout=function(t,e){return void 0===e&&(e=!0),u(this,void 0,void 0,function(){var r,n,i,o;return a(this,function(s){switch(s.label){case 0:return[4,this.initialized];case 1:return s.sent(),(r=this.layouts.find(function(e){return e.name===t}))&&r.hasOwnProperty("fields")?[3,3]:(this.parameters.layout=t,delete this.parameters.fields,[4,this.http.get(this.endpoint,{params:this.parameters})]);case 2:return n=s.sent(),i=n.data,o=this.setFieldsOnLayout(i,t),this.label=i.label,this.parse(i,e),o>-1?this.layouts.splice(o,1,{name:t,label:t,enabled:!0,fields:i.layouts[o].fields}):this.layouts.push({name:t,label:t,enabled:!0,fields:i.fields.map(function(t){return t.name})}),[2,Promise.resolve(i.fields)];case 3:return[2,this.get(r.fields)]}})})},t.prototype.parse=function(t,e){if(void 0===e&&(e=!1),t){if(t&&t.fields){for(var r=function(t){n.memory.hasOwnProperty(t.name)||Object.defineProperty(n,t.name,{get:function(){return this.memory[t.name]},set:function(e){this.memory[t.name]=e},configurable:!0,enumerable:!0}),n.fields.find(function(e){return e.name===t.name})||n.fields.push(t),n.memory[t.name]=t},n=this,i=0,o=t.fields;i<o.length;i++){r(o[i])}this.fields.sort(function(t,e){var r=t.sortOrder?t.sortOrder:t.name,n=e.sortOrder?e.sortOrder:e.name;return r>n?1:n>r?-1:0})}if(t&&t.layouts)for(var s=function(t){var e=u.layouts.find(function(e){return e.name===t.name});e?t.fields&&(e.fields=t.fields):u.layouts.push(t)},u=this,a=0,c=t.layouts;a<c.length;a++){s(c[a])}t&&t.trackTrigger&&(this.trackTrigger=t.trackTrigger,this.tracks=t.tracks),t&&t.sectionHeaders&&(this.sectionHeaders=t.sectionHeaders),t.fields=e?t.fields:this.fields,t.layouts=this.layouts,t.trackTrigger=this.trackTrigger,t.tracks=this.tracks,t.sectionHeaders=this.sectionHeaders,t.allFieldsLoaded=t.allFieldsLoaded||this.allFieldsLoaded,this.allFieldsLoaded=t.allFieldsLoaded,qt.put(this.endpoint,t)}},t.prototype.missing=function(t){if(!this.memory)return t;if(t&&"*"===t[0]&&this.allFieldsLoaded)return[];for(var e=[],r=0,n=t;r<n.length;r++){var i=n[r],o=this._clean(i);this.memory[o]||e.push(o)}return e},t.prototype._clean=function(t){return t.split(".")[0].split("[")[0].split("(")[0]},t.prototype.extract=function(t){if(!this.memory)return[];if(t&&"*"===t[0])return Object.values(this.memory);for(var e=[],r=0,n=t;r<n.length;r++){var i=n[r],o=this._clean(i),s=this.memory[o];s&&"id"===s.name?e.unshift(s):e.push(s)}return e},t.validate=function(){return u(this,void 0,void 0,function(){var t,e,r,n,i,o;return a(this,function(s){switch(s.label){case 0:return[4,Wt.http()];case 1:return[4,s.sent().get("/meta")];case 2:if(t=s.sent(),!(e=t.data))return[3,7];r=0,n=e,s.label=3;case 3:return r<n.length?(i=n[r]).dateLastModified?[4,qt.get("meta/"+i.entity)]:[3,5]:[3,7];case 4:return(o=s.sent())&&o.dateLastModified!==i.dateLastModified&&qt.remove("meta/"+i.entity),[3,6];case 5:qt.remove("meta/"+i.entity),s.label=6;case 6:return r++,[3,3];case 7:return[2,!0]}})})},t.preload=function(e){return u(this,void 0,void 0,function(){var r;return a(this,function(n){return r=new t(e),[2,Promise.all([r.get(["*"]),r.getAllLayouts()])]})})},t.BASIC="basic",t.FULL="full",t.TRACK="track",t}(),Gt=function(){function t(t){this._fields=[],this.type=t,this.endpoint="entity/"+this.type,this.meta=new Jt(this.type),this.parameters={fields:this._fields||["id"]},this.initialized=this.initialize()}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return t=this,[4,Wt.http()];case 1:return t.http=e.sent(),[2]}})})},t.prototype.fields=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,n=Array.isArray(t[0])?t[0]:t;r<n.length;r++){var i=n[r];this._fields.includes(i)||this._fields.push(i)}return this.parameters||(this.parameters={}),this.parameters.fields=this._fields,this},t.prototype.params=function(t){return this.parameters=s({},this.parameters,t),this},t.prototype.get=function(t){return u(this,void 0,void 0,function(){var e,r,n,i;return a(this,function(o){switch(o.label){case 0:return[4,this.initialized];case 1:return o.sent(),[4,Promise.all([this.http.get(this.endpoint+"/"+t,{params:this.parameters}),this.meta.getFull(this.parameters.fields,this.parameters.layout)])];case 2:return e=o.sent(),r=e[0],n=e[1],(i=r.data).meta=n,[2,i]}})})},t.prototype.edit=function(t){return u(this,void 0,void 0,function(){var e,r,n,i,o,u;return a(this,function(a){switch(a.label){case 0:return[4,this.initialized];case 1:return a.sent(),e="RecordEdit",delete(r=s({},this.parameters,{layout:e})).fields,[4,Promise.all([this.http.get(this.endpoint+"/"+t,{params:r}),this.meta.getFull(this.parameters.fields,e)])];case 2:return n=a.sent(),i=n[0],o=n[1],(u=i.data).meta=o,[2,u]}})})},t.prototype.many=function(t,e,r,n){return void 0===n&&(n={}),u(this,void 0,void 0,function(){return a(this,function(i){switch(i.label){case 0:return[4,this.initialized];case 1:return i.sent(),[4,this.http.get(this.endpoint+"/"+r.id+"/"+t,{params:s({fields:e,showTotalMatched:!0},n)})];case 2:return[2,i.sent().data]}})})},t.prototype.save=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),t&&t.id?[2,this.http.post(this.endpoint+"/"+t.id,t)]:[2,this.http.put(this.endpoint,t)]}})})},t.prototype.delete=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),[2,this.http.delete(""+this.endpoint+t)]}})})},t}(),Kt=function(){function t(t,e){void 0===e&&(e=[]),this.subscriptionId=t,this.types=e,this.subscriptionType="entity",this.eventTypes=["INSERTED","UPDATED","DELETED"],this.broker=Pt.getInstance(),this._lastRequestId=0,this._setUpObservable().catch(function(){return console.error("Error in Subscription")}),this.initialized=this.initialize()}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return t=this,[4,Wt.http()];case 1:return t.http=e.sent(),[2]}})})},Object.defineProperty(t.prototype,"endpoint",{get:function(){return"event/subscription/"+this.subscriptionId},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),[4,this.http.put(this.endpoint,{params:{type:this.subscriptionType,eventTypes:this.eventTypes,names:this.types}})];case 2:return[2,t.sent().data]}})})},t.prototype.unsubscribe=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),[4,this.http.delete(this.endpoint)];case 2:return[2,t.sent().data]}})})},t.prototype.get=function(){return u(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),[4,this.http.get(this.endpoint,{params:{maxEvents:100}})];case 2:return t=e.sent(),this._lastRequestId=t.data.requestId,[2,t.data.events]}})})},t.prototype._setUpObservable=function(){return u(this,void 0,void 0,function(){var t=this;return a(this,function(e){switch(e.label){case 0:return[4,this.unsubscribe()];case 1:return e.sent(),[4,this.subscribe()];case 2:return e.sent(),setInterval(function(){return u(t,void 0,void 0,function(){var t,e,r,n;return a(this,function(i){switch(i.label){case 0:return[4,this.get()];case 1:for(t=i.sent(),e=0,r=t;e<r.length;e++)n=r[e],this.broker.emit(n.entityName+":"+n.entityId+":invalidate",n);return[2]}})})},5e3),[2]}})})},t}(),Xt=function(){function t(){throw new TypeError("Cannot invoke the constructor function of a static class.")}return t.toSearchSyntax=function(e){for(var r=[],n=0,i=Object.keys(e);n<i.length;n++){var o=i[n],s=e[o];"or"===o?r.push("("+t.toSearchSyntax(s).replace(/ AND /g," OR ")+")"):r.push(t.parseSearchValue(o,s))}return r.join(" AND ")},t.parseSearchValue=function(e,r){var n=[];if(Array.isArray(r))n.push(e+":"+t.writeLuceneValues(r));else if(r instanceof Object){if((r.min||r.max)&&n.push(e+":["+t.writeLuceneValue(r.min||"*")+" TO "+t.writeLuceneValue(r.max||"*")+"]"),r.any&&Array.isArray(r.any)){var i=r.any.map(function(t){return~(""+t).trim().indexOf(" ")?'"'+t+'"':t});n.push(e+":("+i.join(" ")+")")}if(r.all&&Array.isArray(r.all)){i=r.all.map(function(t){return~(""+t).trim().indexOf(" ")?'"'+t+'"':t});n.push(e+":("+i.join(" AND ")+")")}if(r.not&&n.push("NOT ("+t.parseSearchValue(e,r.not)+")"),r.like&&n.push(e+":("+r.like+"*)"),r.lookup&&n.push(e+':"^('+t.toQuerySyntax(r.lookup)+')"'),r.with&&n.push(e+'.id:"[0 TO *]"'),r.without&&n.push("-"+e+'.id:"[0 TO *]"'),r.or){var o={};o[e]=r.or,n.push(("("+t.toSearchSyntax(o)+")").replace(" AND "," OR "))}null!==r.memberOf&&void 0!==r.memberOf&&Array.isArray(r.memberOf)&&n.push(e+".id: ("+r.memberOf.join(" ")+")");for(var s=0,u=Object.keys(r);s<u.length;s++){var a=u[s];if(["min","max","any","all","not","or","like","lookup","with","without","isNull","memberOf"].indexOf(a)<0){var c=r[a];n.push(t.parseSearchValue(e+"."+a,c))}}}else r.indexOf&&~r.indexOf("*")?n.push(e+":("+r+")"):n.push(e+":"+t.writeLuceneValue(r));return n.join(" AND ")},t.writeLuceneValue=function(t){return t instanceof Date?t.toISOString().split(".")[0].replace(/[-:T]/gi,""):"number"==typeof t||"boolean"==typeof t?""+t:"*"===t?""+t:'"'+t+'"'},t.writeLuceneValues=function(t){return"number"==typeof t[0]||"boolean"==typeof t[0]?"("+t.join(" ")+")":'("'+t.join('" "')+'")'},t.toQuerySyntax=function(e){for(var r=[],n=0,i=Object.keys(e);n<i.length;n++){var o=i[n],s=e[o];"or"===o?r.push("("+t.toQuerySyntax(s).replace(/ AND /g," OR ")+")"):r.push(t.parseQueryValue(o,s))}return r.join(" AND ")},t.parseQueryValue=function(e,r,n){void 0===n&&(n=!1);var i=[],o=n?" NOT IN ":" IN ",s=n?"<>":"=",u=n?"<":">=",a=n?">=":"<";if(Array.isArray(r))i.push(""+e+o+"("+t.writeQueryValues(r)+")");else if(r instanceof Object){if("boolean"==typeof r.isNull){var c=r.isNull?"IS NULL":"IS NOT NULL";i.push(e+" "+c)}var f;if(null!==r.min&&void 0!==r.min&&i.push(""+e+u+t.writeQueryValue(r.min)),null!==r.max&&void 0!==r.max&&i.push(""+e+a+t.writeQueryValue(r.max)),r.any&&Array.isArray(r.any)&&i.push(""+e+o+"("+t.writeQueryValues(r.any)+")"),r.all&&Array.isArray(r.all)&&i.push(""+e+o+"("+t.writeQueryValues(r.all)+")"),null!==r.not&&void 0!==r.not&&i.push(t.parseQueryValue(e,r.not,!0)),null!==r.like&&void 0!==r.like&&i.push(e+" like '%"+r.like+"%'"),null!==r.lookup&&void 0!==r.lookup)(f={})[e]=r.lookup,i.push(t.toQuerySyntax(f));if(null!==r.with&&void 0!==r.with&&i.push(e+" IS NOT EMPTY"),null!==r.without&&void 0!==r.without&&i.push(e+" IS EMPTY"),null!==r.or&&void 0!==r.or)(f={})[e]=r.or,i.push(t.toQuerySyntax(f).replace("AND","OR"));if(null!==r.memberOf&&void 0!==r.memberOf&&Array.isArray(r.memberOf)){for(var h=[],l=0,p=r.memberOf;l<p.length;l++){var d=p[l];n?h.push(d+" NOT MEMBER OF "+e):h.push(d+" MEMBER OF "+e)}n?i.push("("+h.join(" AND ")+")"):i.push("("+h.join(" OR ")+")")}for(var b=0,y=Object.keys(r);b<y.length;b++){var v=y[b];if(["min","max","any","all","not","or","like","lookup","with","without","isNull","memberOf"].indexOf(v)<0){var m=r[v];i.push(t.parseQueryValue(e+"."+v,m))}}}else i.push(""+e+s+t.writeQueryValue(r));return i.join(" AND ")},t.writeQueryValue=function(t){return t instanceof Date?t.getTime():"number"==typeof t||"boolean"==typeof t?""+t:"'"+t.replace(/\*/g,"")+"'"},t.writeQueryValues=function(t){return"number"==typeof t[0]||"boolean"==typeof t[0]?""+t.join(","):"'"+t.join("','")+"'"},t}(),Zt=function(){function t(t){this.entity=t,this.records=[],this.parameters={fields:["id"],orderBy:["-dateAdded"],start:0,count:10},this._page=0,this.initialized=this.initialize(),this.meta=new Jt(t)}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return t=this,[4,Wt.http()];case 1:return t.http=e.sent(),[2]}})})},Object.defineProperty(t.prototype,"endpoint",{get:function(){return this._endpoint||"query/"+this.entity},set:function(t){this._endpoint=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"total",{get:function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),this._lastResponse&&this._lastResponse.total?[2,Promise.resolve(this._lastResponse.total)]:[2,this.http.get(this.endpoint,{params:s({fields:"id",count:0},this.parameters)}).then(function(t){return t.data}).then(function(t){return t.total||0})]}})})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"snapshot",{get:function(){return this._lastResponse},enumerable:!0,configurable:!0}),t.prototype.fields=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.parameters.fields=t[0]instanceof Array?t[0]:t,this},t.prototype.sort=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.parameters.orderBy=t[0]instanceof Array?t[0]:t,this},t.prototype.where=function(t){return this.query(Xt.toQuerySyntax(t))},t.prototype.query=function(t){return this.parameters.where=t,this},t.prototype.count=function(t){return this.parameters.count=t,this},t.prototype.page=function(t){return this._page=t,this.parameters.start=this.parameters.count*t,this},t.prototype.nextpage=function(){return u(this,void 0,void 0,function(){return a(this,function(t){return[2,this.page(++this._page).run(!0)]})})},t.prototype.params=function(t){return this.parameters=s({},this.parameters,t),this},t.prototype.get=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){return[2,this.run(t)]})})},t.prototype.run=function(t){return u(this,void 0,void 0,function(){var e=this;return a(this,function(r){switch(r.label){case 0:return[4,this.initialized];case 1:return r.sent(),[2,Promise.all([this.http.get(this.endpoint,{params:this.parameters}),this.meta.getFull(this.parameters.fields,this.parameters.layout)]).then(function(t){var e=t[0],r=t[1];return[e.data,r]}).then(function(r){var n=r[0],i=r[1];e._lastResponse=n;var o=n.data;return e.records=t?e.records.concat(o):o,n.meta=i,n})]}})})},t.prototype.then=function(t,e){return u(this,void 0,void 0,function(){return a(this,function(r){return[2,this.run(!1).then(t,e)]})})},t}(),te=function(){function t(t){this.optionType=t,this.records=[],this.parameters={filter:void 0,start:0,count:10},this._page=0,this.initialized=this.initialize()}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return t=this,[4,Wt.http()];case 1:return t.http=e.sent(),[2]}})})},Object.defineProperty(t.prototype,"endpoint",{get:function(){return this._endpoint||"options/"+this.optionType},set:function(t){this._endpoint=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"snapshot",{get:function(){return this._lastResponse},enumerable:!0,configurable:!0}),t.prototype.filter=function(t){return this.parameters.filter=t,this},t.prototype.count=function(t){return this.parameters.count=t,this},t.prototype.page=function(t){return this._page=t,this.parameters.start=this.parameters.count*t,this},t.prototype.nextpage=function(){return u(this,void 0,void 0,function(){return a(this,function(t){return[2,this.page(++this._page).run(!0)]})})},t.prototype.params=function(t){return this.parameters=s({},this.parameters,t),this},t.prototype.get=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){return[2,this.run(t)]})})},t.prototype.run=function(t){return u(this,void 0,void 0,function(){var e=this;return a(this,function(r){switch(r.label){case 0:return[4,this.initialized];case 1:return r.sent(),[2,this.http.get(this.endpoint,{params:this.parameters}).then(function(t){return t.data}).then(function(r){e._lastResponse=r;var n=r.data;return e.records=t?e.records.concat(n):n,r}).catch(function(t){return t})]}})})},t.prototype.then=function(t,e){return u(this,void 0,void 0,function(){return a(this,function(r){return[2,this.run(!1).then(t,e)]})})},t}(),ee=function(){function t(t,e){void 0===e&&(e={}),this.types=t,this.options=e,this.records=[],this.parameters={entity:[],filter:void 0,count:10,isCountPerEntity:!0},this.initialized=this.initialize(),this.params(s({entity:this.types},this.options))}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return t=this,[4,Wt.http()];case 1:return t.http=e.sent(),[2]}})})},Object.defineProperty(t.prototype,"endpoint",{get:function(){return this._endpoint||"lookup/expanded"},set:function(t){this._endpoint=t},enumerable:!0,configurable:!0}),t.prototype.filter=function(t){return this.parameters.filter=t,this},t.prototype.count=function(t){return this.parameters.count=t,this},t.prototype.params=function(t){return this.parameters=s({},this.parameters,t),this},t.prototype.get=function(){return u(this,void 0,void 0,function(){return a(this,function(t){return[2,this.run()]})})},t.prototype.run=function(){return u(this,void 0,void 0,function(){var t=this;return a(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),[2,this.http.get(this.endpoint,{params:this.parameters}).then(function(t){return t.data}).then(function(e){return t.records=e,e}).catch(function(t){return t})]}})})},t.prototype.then=function(t,e){return u(this,void 0,void 0,function(){return a(this,function(r){return[2,this.run().then(t,e)]})})},t}(),re=function(t){function e(e){var r=t.call(this,e)||this;return r.parameters={fields:["id"],sort:["-dateAdded"],start:0,count:10},r}return o(e,t),Object.defineProperty(e.prototype,"endpoint",{get:function(){return this._endpoint||"search/"+this.entity},set:function(t){this._endpoint=t},enumerable:!0,configurable:!0}),e.prototype.sort=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.parameters.sort=t[0]instanceof Array?t[0]:t,this},e.prototype.where=function(t){return this.query(Xt.toSearchSyntax(t))},e.prototype.query=function(t){return this.parameters.query=t,this},e.prototype.then=function(t,e){return u(this,void 0,void 0,function(){return a(this,function(r){return[2,this.run(!1).then(t,e)]})})},e}(Zt),ne=function(){function t(){this.allSettingsAndEntitlementsEndpoint="services/Settings/allEntitlementsAndSettings",this.initialized=this.initialize()}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return t=this,[4,Wt.http()];case 1:return t.http=e.sent(),[2]}})})},t.prototype.getSettings=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),[4,this.http.get("settings/"+t.join())];case 2:return[2,e.sent().data]}})})},t.prototype.getEntitlements=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),[4,this.http.get("entitlements/"+t)];case 2:return[2,e.sent().data]}})})},t.prototype.getAllSettingsAndEntitlements=function(t){return void 0===t&&(t=!1),u(this,void 0,void 0,function(){var e,r,n;return a(this,function(i){switch(i.label){case 0:return[4,this.initialized];case 1:return i.sent(),(r=t)?[4,qt.has(this.allSettingsAndEntitlementsEndpoint)]:[3,3];case 2:r=i.sent(),i.label=3;case 3:return r?[4,qt.get(this.allSettingsAndEntitlementsEndpoint)]:[3,5];case 4:return e=i.sent(),[3,7];case 5:return[4,this.http.get(this.allSettingsAndEntitlementsEndpoint)];case 6:n=i.sent(),e=n.data,t&&qt.put(this.allSettingsAndEntitlementsEndpoint,e),i.label=7;case 7:return e&&e.dashboardEntitlements&&e.entitlements&&(e.entitlements.Dashboard=e.dashboardEntitlements),[2,e]}})})},t}(),ie=function(){function t(){}return t.prototype.validateCode=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){return[2,r.post(this.config.token_url+"?grant_type=authorization_code&code="+t+"&client_id="+this.config.client_id+"&client_secret="+this.config.client_secret).then(function(t){return t.data})]})})},t.prototype.restLogin=function(t){return u(this,void 0,void 0,function(){var e;return a(this,function(n){return e=this.config.ttl?"&ttl="+this.config.ttl:"",[2,r.post(this.config.login_url+"?version=*&access_token="+t+e).then(function(t){return t.data})]})})},t}(),oe=function(){function t(t,e){this.username=t,this.password=e}return t.prototype.credential=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){return[2,r.get(t.login_url+"?version=*&username="+this.username+"&password="+this.password+"&clientId="+t.client_id).then(function(t){return t.data})]})})},t}(),se=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.credential=function(t){return u(this,void 0,void 0,function(){var e,r;return a(this,function(n){switch(n.label){case 0:return this.config=t,[4,this.getAuthCode()];case 1:return e=n.sent(),[4,this.validateCode(e)];case 2:return r=n.sent(),[2,this.restLogin(r.access_token)]}})})},e.prototype.getAuthCode=function(){return u(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,r.get(""+this.config.authorization_url,{params:{client_id:this.config.client_id,response_type:"code",action:"Login",username:this.config.username,password:this.config.password}})];case 1:return[2,e.sent().request.path.split("?code=").pop().split("&").shift()];case 2:throw t=e.sent(),console.warn("Error retrieving AuthCode",t.message),t;case 3:return[2]}})})},e}(ie),ue=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.credential=function(t){return u(this,void 0,void 0,function(){var e,r,n;return a(this,function(i){return this.config=t,e="location=0,status=0,width=800,height=600",r=t.authorization_url+"?response_type=code&clientId="+t.client_id+"&redirect_uri="+t.redirect_url,n=window.open(r,"bhAuthWindow",e),[2,this.getAuthCode(n).then(this.validateCode).then(this.restLogin)]})})},e.prototype.getAuthCode=function(t){return u(this,void 0,void 0,function(){var e=this;return a(this,function(r){return[2,Promise.resolve().then(function(){var r=window.setInterval(function(){try{if(-1!==t.document.URL.indexOf(e.config.redirect_url)){window.clearInterval(r);var n=Yt.destruct(t.document.URL);return t.close(),n.params.access_token}}catch(t){console.warn("Error retrieving AuthCode",t.message)}},1e3)})]})})},e}(ie),ae=Symbol("EMPTY"),ce=function(t){function r(e){void 0===e&&(e=ae);var r=t.call(this)||this;return r._value=e,r}return o(r,t),Object.defineProperty(r.prototype,"snapshot",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),r.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);return r&&!r.closed&&this.hasValue()&&e.next(this._value),r},r.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new e.ObjectUnsubscribedError;return this._value},r.prototype.hasValue=function(){return!this.hasError&&(!this.closed&&this._value!==ae)},r.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},r.prototype.once=function(){return this.pipe((t=1,function(e){return 0===t?et():e.lift(new pt(t))}));var t},r}(e.Subject),fe=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isFunction=function(t){return"function"==typeof t}});Bt(fe);fe.isFunction;var he=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=!1;e.config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){var e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else r&&console.log("RxJS: Back to a better error behavior. Thank you. <3");r=t},get useDeprecatedSynchronousErrorHandling(){return r}}});Bt(he);he.config;var le=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.hostReportError=function(t){setTimeout(function(){throw t})}});Bt(le);le.hostReportError;var pe=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.empty={closed:!0,next:function(t){},error:function(t){if(he.config.useDeprecatedSynchronousErrorHandling)throw t;le.hostReportError(t)},complete:function(){}}});Bt(pe);pe.empty;var de=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isArray=Array.isArray||function(t){return t&&"number"==typeof t.length}});Bt(de);de.isArray;var be=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isObject=function(t){return null!=t&&"object"==typeof t}});Bt(be);be.isObject;var ye=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.errorObject={e:{}}});Bt(ye);ye.errorObject;var ve=Ut(function(t,e){var r;function n(){try{return r.apply(this,arguments)}catch(t){return ye.errorObject.e=t,ye.errorObject}}Object.defineProperty(e,"__esModule",{value:!0}),e.tryCatch=function(t){return r=t,n}});Bt(ve);ve.tryCatch;var me=Ut(function(t,e){function r(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}Object.defineProperty(e,"__esModule",{value:!0}),r.prototype=Object.create(Error.prototype),e.UnsubscriptionError=r});Bt(me);me.UnsubscriptionError;var ge=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var r=this._parent,i=this._parents,o=this._unsubscribe,s=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var u=-1,a=i?i.length:0;r;)r.remove(this),r=++u<a&&i[u]||null;if(fe.isFunction(o))ve.tryCatch(o).call(this)===ye.errorObject&&(e=!0,t=t||(ye.errorObject.e instanceof me.UnsubscriptionError?n(ye.errorObject.e.errors):[ye.errorObject.e]));if(de.isArray(s))for(u=-1,a=s.length;++u<a;){var c=s[u];if(be.isObject(c))if(ve.tryCatch(c.unsubscribe).call(c)===ye.errorObject){e=!0,t=t||[];var f=ye.errorObject.e;f instanceof me.UnsubscriptionError?t=t.concat(n(f.errors)):t.push(f)}}if(e)throw new me.UnsubscriptionError(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var r=e;switch(typeof e){case"function":r=new t(e);case"object":if(r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if("function"!=typeof r._addParent){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(r),r._addParent(this),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.prototype._addParent=function(t){var e=this._parent,r=this._parents;e&&e!==t?r?-1===r.indexOf(t)&&r.push(t):this._parents=[t]:this._parent=t},t.EMPTY=((e=new t).closed=!0,e),t}();function n(t){return t.reduce(function(t,e){return t.concat(e instanceof me.UnsubscriptionError?e.errors:e)},[])}e.Subscription=r});Bt(ge);ge.Subscription;var _e=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.rxSubscriber="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),e.$$rxSubscriber=e.rxSubscriber});Bt(_e);_e.rxSubscriber,_e.$$rxSubscriber;var we=Ut(function(t,e){var r,n=Ft&&Ft.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(r,n,i){var s=t.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,s._parentSubscription=null,arguments.length){case 0:s.destination=pe.empty;break;case 1:if(!r){s.destination=pe.empty;break}if("object"==typeof r){r instanceof e?(s.syncErrorThrowable=r.syncErrorThrowable,s.destination=r,r.add(s)):(s.syncErrorThrowable=!0,s.destination=new o(s,r));break}default:s.syncErrorThrowable=!0,s.destination=new o(s,r,n,i)}return s}return n(e,t),e.prototype[_e.rxSubscriber]=function(){return this},e.create=function(t,r,n){var i=new e(t,r,n);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this._parentSubscription=null,this},e}(ge.Subscription);e.Subscriber=i;var o=function(t){function e(e,r,n,i){var o,s=t.call(this)||this;s._parentSubscriber=e;var u=s;return fe.isFunction(r)?o=r:r&&(o=r.next,n=r.error,i=r.complete,r!==pe.empty&&(u=Object.create(r),fe.isFunction(u.unsubscribe)&&s.add(u.unsubscribe.bind(u)),u.unsubscribe=s.unsubscribe.bind(s))),s._context=u,s._next=o,s._error=n,s._complete=i,s}return n(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;he.config.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=he.config.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):le.hostReportError(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;le.hostReportError(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};he.config.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),he.config.useDeprecatedSynchronousErrorHandling)throw t;le.hostReportError(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!he.config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return he.config.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(le.hostReportError(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(i);e.SafeSubscriber=o});Bt(we);we.Subscriber,we.SafeSubscriber;var Se=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.canReportError=function(t){for(;t;){var e=t,r=e.closed,n=e.destination,i=e.isStopped;if(r||i)return!1;t=n&&n instanceof we.Subscriber?n:null}return!0}});Bt(Se);Se.canReportError;var Ee=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.toSubscriber=function(t,e,r){if(t){if(t instanceof we.Subscriber)return t;if(t[_e.rxSubscriber])return t[_e.rxSubscriber]()}return t||e||r?new we.Subscriber(t,e,r):new we.Subscriber(pe.empty)}});Bt(Ee);Ee.toSubscriber;var Oe=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.observable="function"==typeof Symbol&&Symbol.observable||"@@observable"});Bt(Oe);Oe.observable;var je=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.noop=function(){}});Bt(je);je.noop;var xe=Ut(function(t,e){function r(t){return t?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:je.noop}Object.defineProperty(e,"__esModule",{value:!0}),e.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(t)},e.pipeFromArray=r});Bt(xe);xe.pipe,xe.pipeFromArray;var Ie=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,i=Ee.toSubscriber(t,e,r);if(n?n.call(i,this.source):i.add(this.source||he.config.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),he.config.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){he.config.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),Se.canReportError(t)?t.error(e):console.warn(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=n(e))(function(e,n){var i;i=r.subscribe(function(e){try{t(e)}catch(t){n(t),i&&i.unsubscribe()}},n,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[Oe.observable]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:xe.pipeFromArray(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=n(t))(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(e){return new t(e)},t}();function n(t){if(t||(t=he.config.Promise||Promise),!t)throw new Error("no Promise impl found");return t}e.Observable=r});Bt(Ie);Ie.Observable;var ke=Ut(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isObservable=function(t){return!!t&&(t instanceof Ie.Observable||"function"==typeof t.lift&&"function"==typeof t.subscribe)}});Bt(ke);var Ae=ke.isObservable;function Te(t,r){return void 0===r&&(r=!0),Dt(t).defined?e.Observable.create(function(n){var i=e.combineLatest(Pe("id",t),Pe("fields",t),Pe("layout",t),Pe("meta",t),Pe("showEditable",t),Pe("showReadOnly",t),Pe("executeFormTriggers",t),Pe("params",t));r&&(i=i.pipe(K(0))),i.subscribe(function(t){var e=t[0],r=t[1],i=t[2],o=t[3],s=t[4],u=t[5],a=t[6],c=t[7],f={};void 0!==e&&(f.id=e),void 0!==r&&(f.fields=r),void 0!==i&&(f.layout=i),void 0!==o&&(f.meta=o),void 0!==s&&(f.showEditable=s),void 0!==u&&(f.showReadOnly=u),void 0!==a&&(f.executeFormTriggers=a),void 0!==c&&(f.params=c),n.next(f)})}):e.of(null)}function Pe(t,r){return Ae(r[t])?r[t]:Rt(r).have(t)?new e.Observable(function(e){e.next(r[t])}):new e.Observable(function(t){t.next(void 0)})}var Ne=function(t){function e(e,r,n){void 0===r&&(r={});var i=t.call(this,n)||this;return i._fields=[],i.broker=Pt.getInstance(),i.type=e,i.$entity=new Gt(i.type),Te(r).subscribe(function(t){if(t)for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e];switch(n){case"fields":i.fields(t.fields);break;case"layout":i.$entity.params({layout:t.layout});break;case"meta":i.$entity.meta.style(t.meta);break;case"showEditable":i.$entity.params({showEditable:t.showEditable});break;case"showReadOnly":i.$entity.params({showReadOnly:t.showReadOnly});break;case"executeFormTriggers":i.$entity.params({executeFormTriggers:t.executeFormTriggers});break;case"params":i.$entity.params(t.params);break;case"id":i.get(t.id);break;default:console.warn("Unknown key in params: "+n)}}}),i.hasValue()&&(i.fields(Object.keys(i.value)),i._setUpObservable(i.value)),i}return o(e,t),e.prototype.fields=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var n=0,i=Array.isArray(e[0])?e[0]:e;n<i.length;n++){var o=i[n];this._fields.includes(o)||(this._proxy(o),this._fields.push(o))}return(t=this.$entity).fields.apply(t,e),this},e.prototype._proxy=function(t){var e=new ce(this.value&&this.value[t]);Object.defineProperty(this,t,{get:function(){return e},set:function(r){var n;this.patch(((n={})[t]=r,n)),e.next(r)},configurable:!0,enumerable:!0})},e.prototype.params=function(t){return t.hasOwnProperty("fields")&&(this.fields(t.fields),delete t.fields),this.$entity.params(t),this},e.prototype.set=function(t){return this.next(t),this.fields(Object.keys(t)),this.broker.emit(this.type+":"+t.id+":value",t),this},e.prototype.patch=function(t,e){void 0===e&&(e=!1);var r=this.value||{},n=s({},r,t);return this.next(n),this.fields(Object.keys(n)),e||this.broker.emit(this.type+":"+n.id+":value",n),this},e.prototype.get=function(t){var e=this;return this.$entity.get(t).then(function(t){return e.descriptor=t.meta,e.patch(t.data),e._setUpObservable(e.getValue()),t}),this},e.prototype.many=function(t,e){var r=this;return this.$entity.many(t,e,this.value).then(function(e){return r._fields.includes(t)||(r._proxy(t),r._fields.push(t)),r.value[t]=e,r.patch({property:e}),r._setUpObservable(r.getValue()),e}),this},e.prototype.save=function(){return u(this,void 0,void 0,function(){var t=this;return a(this,function(e){return[2,this.$entity.save(this.value).then(function(e){var r=e.data;return t.patch({id:r.changedEntityId}),t._setUpObservable(t.getValue()),e})]})})},e.prototype.remove=function(){return u(this,void 0,void 0,function(){return a(this,function(t){return[2,this.$entity.delete(this.value.id)]})})},e.prototype._setUpObservable=function(t){var e=this;t&&t.id&&this.broker.on(this.type+":"+t.id+":value").subscribe(function(t){e.patch(t,!0)})},e}(ce);function Re(t,r){return void 0===r&&(r=!0),Dt(t).defined?e.Observable.create(function(n){var i=e.combineLatest(Pe("fields",t),Pe("layout",t),Pe("meta",t),Pe("orderBy",t),Pe("startAt",t),Pe("limitTo",t),Pe("filter",t),Pe("params",t));r&&(i=i.pipe(K(0))),i.subscribe(function(t){var e=t[0],r=t[1],i=t[2],o=t[3],s=t[4],u=t[5],a=t[6],c=t[7],f={};void 0!==e&&(f.fields=e),void 0!==r&&(f.layout=r),void 0!==i&&(f.meta=i),void 0!==o&&(f.orderBy=o),void 0!==s&&(f.startAt=s),void 0!==u&&(f.limitTo=u),void 0!==a&&(f.filter=a),void 0!==c&&(f.params=c),n.next(f)})}):e.of(null)}var Ce=function(t){function e(e,r,n){void 0===r&&(r={});var i=t.call(this,n)||this;return i.broker=Pt.getInstance(),i.type=e,i.$ref=new Ne(i.type,{}),i.$list=i.getSearcher(i.type),Re(r).subscribe(function(t){if(t)for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e];switch(n){case"fields":i.$list.fields(t.fields);break;case"layout":i.$list.params({layout:t.layout});break;case"meta":i.$list.meta.style(t.meta);break;case"orderBy":i.$list.sort(t.orderBy);break;case"startAt":i.$list.params({start:t.startAt});break;case"limitTo":i.$list.count(t.limitTo||25);break;case"filter":i.$list.where(t.filter);break;case"params":i.$list.params(t.params);break;default:console.warn("Unknown key in params: "+n)}}i.$list.then(function(t){i.descriptor=t.meta,i.$latest=t,i.next(t.data)},function(t){i.error(t)})}),i._setUpObservable(),i}return o(e,t),e.prototype.getSearcher=function(t){return["Candidate","ClientContact","ClientCorporation","JobOrder","Lead","Opportunity","Placement","JobSubmission","Note","UserMessage"].indexOf(t)>=0?new re(this.type):new Zt(this.type)},Object.defineProperty(e.prototype,"lastAdded",{get:function(){return this.$ref},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"info",{get:function(){return{total:this.$latest.total,messages:this.$latest.messages,start:this.$latest.start,count:this.$latest.count}},enumerable:!0,configurable:!0}),e.prototype.findById=function(t){var e=this.getValue().find(function(e){return e.id===t});return e||new Ne(this.type,{id:t})},e.prototype.push=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){return[2,this.$ref.set(t).save().then(this._eventHook("child_added"))]})})},e.prototype.update=function(t,e){return u(this,void 0,void 0,function(){var r=this;return a(this,function(n){return[2,this._checkOperationCases(t,{keyCase:function(){return u(r,void 0,void 0,function(){return a(this,function(r){return[2,this.findById(t).patch(e).save()]})})},entityCase:function(){return u(r,void 0,void 0,function(){return a(this,function(r){return[2,t.patch(e).save()]})})}}).then(this._eventHook("child_updated"))]})})},e.prototype.remove=function(t){return u(this,void 0,void 0,function(){var e=this;return a(this,function(r){return[2,this._checkOperationCases(t,{keyCase:function(){return u(e,void 0,void 0,function(){return a(this,function(e){return[2,this.findById(t).remove()]})})},entityCase:function(){return u(e,void 0,void 0,function(){return a(this,function(e){return[2,t.remove()]})})}}).then(this._eventHook("child_removed"))]})})},e.prototype._setUpObservable=function(){var t=this;this.broker.on(this.type+":*").subscribe(function(){t.$list.then(function(e){t.descriptor=e.meta,t.next(e.data)})})},e.prototype._eventHook=function(t){var e=this;return function(r){return e.broker.emit(e.type+":"+r.changedEntityId+":value",r.data),e.broker.emit(e.type+":"+t,r.data),r}},e.prototype._checkOperationCases=function(t,e){return u(this,void 0,void 0,function(){return a(this,function(r){if(Dt(t).aNumber)return[2,e.keyCase()];if(Dt(t).aTypeOf(Ne))return[2,e.entityCase()];throw new Error("Method requires a key or reference. Got: "+typeof t)})})},e.useSearch=!1,e}(ce);t.EntityMessageBroker=Pt,t.EntityService=Gt,t.EntitySubscription=Kt,t.MetaService=Jt,t.QueryService=Zt,t.OptionsService=te,t.LookupService=ee,t.SearchService=re,t.SettingService=ne,t.Staffing=Wt,t.StaffingOAuthBaseProvider=ie,t.StaffingCredentialsAuthProvider=oe,t.StaffingOAuthProvider=se,t.StaffingOAuthPopupProvider=ue,t.Where=Xt,t.Can=Nt,t.can=Rt,t.Is=Ct,t.is=Dt,t.Cache=qt,t.Deferred=function(){var t={},e=new Promise(function(e,r){t.resolve=e,t.reject=r});return e.resolve=t.resolve,e.reject=t.reject,e},t.Lazy=Qt,t.Memory=Lt,t.QueryString=Yt,t.Browser=zt,t.Entity=Ne,t.observeOptions=Te,t.getOrCreateObservable=Pe,t.EntityList=Ce,t.observeListOptions=Re,t.EMPTY=ae,t.StatefulSubject=ce,Object.defineProperty(t,"__esModule",{value:!0})});
